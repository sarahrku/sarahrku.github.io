<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Functional programming med purrr-pakken | Analyse og visualisering af biologiske datasæt - 2022</title>
  <meta name="description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Functional programming med purrr-pakken | Analyse og visualisering af biologiske datasæt - 2022" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Functional programming med purrr-pakken | Analyse og visualisering af biologiske datasæt - 2022" />
  
  <meta name="twitter:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

<meta name="author" content="Sarah Rennie" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bearbejdning-dag-2.html"/>
<link rel="next" href="visualisering-af-trends.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualisering kursus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Grundlæggende R<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inledning-til-kapitel"><i class="fa fa-check"></i><b>1.1</b> Inledning til kapitel<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#de-forskellige-vinduer-i-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> De forskellige vinduer i RStudio<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-pakker"><i class="fa fa-check"></i><b>1.4</b> R pakker<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#hvor-kommer-vores-data-fra"><i class="fa fa-check"></i><b>1.5</b> Hvor kommer vores data fra?<span></span></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#indbyggede-datasæt"><i class="fa fa-check"></i><b>1.5.1</b> Indbyggede datasæt<span></span></a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#importering-af-data-fra-.txt-fil"><i class="fa fa-check"></i><b>1.5.2</b> Importering af data fra .txt fil<span></span></a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#importering-af-data-fra-excel"><i class="fa fa-check"></i><b>1.5.3</b> Importering af data fra Excel<span></span></a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#kaggle"><i class="fa fa-check"></i><b>1.5.4</b> Kaggle<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#beregninger-i-r"><i class="fa fa-check"></i><b>1.6</b> Beregninger i R<span></span></a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#vectorer"><i class="fa fa-check"></i><b>1.6.1</b> Vectorer<span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#datatyper"><i class="fa fa-check"></i><b>1.6.2</b> datatyper<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#dataframes"><i class="fa fa-check"></i><b>1.7</b> Dataframes<span></span></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#delmægder-af-dataframes"><i class="fa fa-check"></i><b>1.7.1</b> Delmægder af dataframes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Descriptive statistics<span></span></a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#simulere-data-fra-den-normale-fordeling"><i class="fa fa-check"></i><b>1.8.1</b> Simulere data fra den normale fordeling<span></span></a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.8.2</b> Measures of central tendency<span></span></a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#tapply"><i class="fa fa-check"></i><b>1.8.3</b> <code>tapply()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#statistike-tester"><i class="fa fa-check"></i><b>1.9</b> Statistike tester<span></span></a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#korrelation"><i class="fa fa-check"></i><b>1.9.1</b> Korrelation<span></span></a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#test-for-uafhængighed-chi-sq-test"><i class="fa fa-check"></i><b>1.9.2</b> Test for uafhængighed (chi-sq test)<span></span></a></li>
<li class="chapter" data-level="1.9.3" data-path="index.html"><a href="index.html#sample-t-test"><i class="fa fa-check"></i><b>1.9.3</b> 1 sample t-test<span></span></a></li>
<li class="chapter" data-level="1.9.4" data-path="index.html"><a href="index.html#sample-t-test-1"><i class="fa fa-check"></i><b>1.9.4</b> 2-sample t-test<span></span></a></li>
<li class="chapter" data-level="1.9.5" data-path="index.html"><a href="index.html#paired-t-test"><i class="fa fa-check"></i><b>1.9.5</b> Paired t-test<span></span></a></li>
<li class="chapter" data-level="1.9.6" data-path="index.html"><a href="index.html#anova-variansanalyse"><i class="fa fa-check"></i><b>1.9.6</b> ANOVA (variansanalyse)<span></span></a></li>
<li class="chapter" data-level="1.9.7" data-path="index.html"><a href="index.html#lineær-regression"><i class="fa fa-check"></i><b>1.9.7</b> Lineær regression<span></span></a></li>
<li class="chapter" data-level="1.9.8" data-path="index.html"><a href="index.html#r-squared-coefficient-of-determination"><i class="fa fa-check"></i><b>1.9.8</b> R-squared coefficient of determination<span></span></a></li>
<li class="chapter" data-level="1.9.9" data-path="index.html"><a href="index.html#antagelser---lineær-regression"><i class="fa fa-check"></i><b>1.9.9</b> Antagelser - lineær regression<span></span></a></li>
<li class="chapter" data-level="1.9.10" data-path="index.html"><a href="index.html#multiple-lineær-regression"><i class="fa fa-check"></i><b>1.9.10</b> Multiple lineær regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#problemstillinger"><i class="fa fa-check"></i><b>1.10</b> Problemstillinger<span></span></a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="index.html"><a href="index.html#quiz---basics"><i class="fa fa-check"></i><b>1.10.1</b> Quiz - Basics<span></span></a></li>
<li class="chapter" data-level="1.10.2" data-path="index.html"><a href="index.html#grundlæggende-r"><i class="fa fa-check"></i><b>1.10.2</b> Grundlæggende R<span></span></a></li>
<li class="chapter" data-level="1.10.3" data-path="index.html"><a href="index.html#kort-analyse-med-reaktionstider"><i class="fa fa-check"></i><b>1.10.3</b> Kort analyse med reaktionstider<span></span></a></li>
<li class="chapter" data-level="1.10.4" data-path="index.html"><a href="index.html#ekstra-øvelser-med-statistik-tests"><i class="fa fa-check"></i><b>1.10.4</b> Ekstra øvelser med statistik tests<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduktion til R Markdown<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#hvad-er-r-markdown"><i class="fa fa-check"></i><b>2.1</b> Hvad er R Markdown?<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#installere-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Installere R Markdown<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#videodemonstrationer"><i class="fa fa-check"></i><b>2.3</b> Videodemonstrationer<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#oprette-et-nyt-dokument-i-r-markdown"><i class="fa fa-check"></i><b>2.4</b> Oprette et nyt dokument i R Markdown<span></span></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml"><i class="fa fa-check"></i><b>2.4.1</b> YAML<span></span></a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#globale-options"><i class="fa fa-check"></i><b>2.4.2</b> Globale options<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#skrive-baseret-tekst"><i class="fa fa-check"></i><b>2.5</b> Skrive baseret tekst<span></span></a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.5.1</b> Headers<span></span></a></li>
<li class="chapter" data-level="2.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#liste"><i class="fa fa-check"></i><b>2.5.2</b> liste<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#knitte-kode"><i class="fa fa-check"></i><b>2.6</b> Knitte kode<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#kode-chunks"><i class="fa fa-check"></i><b>2.7</b> Kode chunks<span></span></a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rmarkdown.html"><a href="rmarkdown.html#et-godt-råd-når-man-arbejder-med-chunks"><i class="fa fa-check"></i><b>2.7.1</b> Et godt råd når man arbejder med chunks<span></span></a></li>
<li class="chapter" data-level="2.7.2" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-indstillinger"><i class="fa fa-check"></i><b>2.7.2</b> Chunk indstillinger<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#r-beregninger-indenfor-teksten-i-dokument-inline-code"><i class="fa fa-check"></i><b>2.8</b> R beregninger indenfor teksten i dokument (‘inline code’)<span></span></a></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory-1"><i class="fa fa-check"></i><b>2.9</b> Working directory<span></span></a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#matematik"><i class="fa fa-check"></i><b>2.10</b> Matematik<span></span></a></li>
<li class="chapter" data-level="2.11" data-path="rmarkdown.html"><a href="rmarkdown.html#problemstillinger-1"><i class="fa fa-check"></i><b>2.11</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="2.12" data-path="rmarkdown.html"><a href="rmarkdown.html#færdig-for-i-dag-og-næste-gang"><i class="fa fa-check"></i><b>2.12</b> Færdig for i dag og næste gang<span></span></a></li>
<li class="chapter" data-level="2.13" data-path="rmarkdown.html"><a href="rmarkdown.html#ekstra-links"><i class="fa fa-check"></i><b>2.13</b> Ekstra links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>3</b> Visualisering - ggplot2 dag 1<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="visual1.html"><a href="visual1.html#inledning-og-videoer"><i class="fa fa-check"></i><b>3.1</b> Inledning og videoer<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="visual1.html"><a href="visual1.html#læringsmålene-for-dag-1"><i class="fa fa-check"></i><b>3.1.1</b> Læringsmålene for dag 1<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="visual1.html"><a href="visual1.html#hvad-er-ggplot2"><i class="fa fa-check"></i><b>3.1.2</b> Hvad er <strong>ggplot2</strong>?<span></span></a></li>
<li class="chapter" data-level="3.1.3" data-path="visual1.html"><a href="visual1.html#brugen-af-materialerne"><i class="fa fa-check"></i><b>3.1.3</b> Brugen af materialerne<span></span></a></li>
<li class="chapter" data-level="3.1.4" data-path="visual1.html"><a href="visual1.html#video-ressourcer"><i class="fa fa-check"></i><b>3.1.4</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visual1.html"><a href="visual1.html#transition-fra-base-r-til-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Transition fra base R til ggplot2<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="visual1.html"><a href="visual1.html#vores-første-ggplot"><i class="fa fa-check"></i><b>3.3</b> Vores første ggplot<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="visual1.html"><a href="visual1.html#lidt-om-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Lidt om ggplot2<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visual1.html"><a href="visual1.html#syntax"><i class="fa fa-check"></i><b>3.4.1</b> Syntax<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="visual1.html"><a href="visual1.html#hvad-betyder-egentlig-grammar-of-graphics"><i class="fa fa-check"></i><b>3.4.2</b> Hvad betyder egentlig grammar of graphics?<span></span></a></li>
<li class="chapter" data-level="3.4.3" data-path="visual1.html"><a href="visual1.html#globale-versus-lokale-æstetik"><i class="fa fa-check"></i><b>3.4.3</b> Globale versus lokale æstetik<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visual1.html"><a href="visual1.html#specificere-etiketter-og-titel"><i class="fa fa-check"></i><b>3.5</b> Specificere etiketter og titel<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="visual1.html"><a href="visual1.html#ændre-farver"><i class="fa fa-check"></i><b>3.6</b> Ændre farver<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="visual1.html"><a href="visual1.html#ændre-tema"><i class="fa fa-check"></i><b>3.7</b> Ændre tema<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="visual1.html"><a href="visual1.html#forskellige-geoms"><i class="fa fa-check"></i><b>3.8</b> Forskellige geoms<span></span></a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visual1.html"><a href="visual1.html#boxplot-geom_box"><i class="fa fa-check"></i><b>3.8.1</b> Boxplot (<code>geom_box</code>)<span></span></a></li>
<li class="chapter" data-level="3.8.2" data-path="visual1.html"><a href="visual1.html#barplot-geom_bar"><i class="fa fa-check"></i><b>3.8.2</b> Barplot (<code>geom_bar</code>)<span></span></a></li>
<li class="chapter" data-level="3.8.3" data-path="visual1.html"><a href="visual1.html#histogram-geom_histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram (<code>geom_histogram</code>)<span></span></a></li>
<li class="chapter" data-level="3.8.4" data-path="visual1.html"><a href="visual1.html#density-geom_density"><i class="fa fa-check"></i><b>3.8.4</b> Density (<code>geom_density</code>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visual1.html"><a href="visual1.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting<span></span></a></li>
<li class="chapter" data-level="3.10" data-path="visual1.html"><a href="visual1.html#problemstillinger-2"><i class="fa fa-check"></i><b>3.10</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="3.11" data-path="visual1.html"><a href="visual1.html#næste-gang"><i class="fa fa-check"></i><b>3.11</b> Næste gang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual2.html"><a href="visual2.html"><i class="fa fa-check"></i><b>4</b> Visualisering - ggplot2 dag 2<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="visual2.html"><a href="visual2.html#indledning-og-videoer"><i class="fa fa-check"></i><b>4.1</b> Indledning og videoer<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visual2.html"><a href="visual2.html#læringsmålene"><i class="fa fa-check"></i><b>4.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="visual2.html"><a href="visual2.html#video-ressourcer-1"><i class="fa fa-check"></i><b>4.1.2</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visual2.html"><a href="visual2.html#koordinat-systemer"><i class="fa fa-check"></i><b>4.2</b> Koordinat systemer<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visual2.html"><a href="visual2.html#zoom-coord_cartesian-expand_limits"><i class="fa fa-check"></i><b>4.2.1</b> Zoom (<code>coord_cartesian()</code>, <code>expand_limits()</code>)<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="visual2.html"><a href="visual2.html#transformering-af-akserne---log-sqrt-osv-scale_x_continuous."><i class="fa fa-check"></i><b>4.2.2</b> Transformering af akserne - log, sqrt osv (<code>scale_x_continuous</code>).<span></span></a></li>
<li class="chapter" data-level="4.2.3" data-path="visual2.html"><a href="visual2.html#flip-coordinates-coord_flip"><i class="fa fa-check"></i><b>4.2.3</b> Flip coordinates (<code>coord_flip</code>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visual2.html"><a href="visual2.html#mere-om-farver-og-punkt-former"><i class="fa fa-check"></i><b>4.3</b> Mere om farver og punkt former<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visual2.html"><a href="visual2.html#automatisk-farver"><i class="fa fa-check"></i><b>4.3.1</b> Automatisk farver<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="visual2.html"><a href="visual2.html#manuelle-farver"><i class="fa fa-check"></i><b>4.3.2</b> Manuelle farver<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="visual2.html"><a href="visual2.html#punkt-former"><i class="fa fa-check"></i><b>4.3.3</b> Punkt former<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visual2.html"><a href="visual2.html#annotations-geom_text"><i class="fa fa-check"></i><b>4.4</b> Annotations (<code>geom_text</code>)<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visual2.html"><a href="visual2.html#tilføje-labeller-direkte-på-plottet."><i class="fa fa-check"></i><b>4.4.1</b> Tilføje labeller direkte på plottet.<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="visual2.html"><a href="visual2.html#pakken-ggrepel-for-at-tilføje-tekst-labeller"><i class="fa fa-check"></i><b>4.4.2</b> Pakken <code>ggrepel</code> for at tilføje tekst labeller<span></span></a></li>
<li class="chapter" data-level="4.4.3" data-path="visual2.html"><a href="visual2.html#tilføje-rektangler-i-regioner-af-interesse-annotate"><i class="fa fa-check"></i><b>4.4.3</b> Tilføje rektangler i regioner af interesse (<code>annotate</code>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visual2.html"><a href="visual2.html#adskille-plots-med-facets-facet_gridfacet_wrap"><i class="fa fa-check"></i><b>4.5</b> Adskille plots med facets (<code>facet_grid</code>/<code>facet_wrap</code>)<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="visual2.html"><a href="visual2.html#gemme-dit-plot"><i class="fa fa-check"></i><b>4.6</b> Gemme dit plot<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="visual2.html"><a href="visual2.html#problemstillinger-3"><i class="fa fa-check"></i><b>4.7</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="visual2.html"><a href="visual2.html#ekstra-links-1"><i class="fa fa-check"></i><b>4.8</b> Ekstra links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Bearbejdning dag 1<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#hvad-er-tidyverse"><i class="fa fa-check"></i><b>5.1</b> Hvad er Tidyverse?<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#video-ressourcer-2"><i class="fa fa-check"></i><b>5.2</b> Video ressourcer<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#oversigt-over-pakker"><i class="fa fa-check"></i><b>5.3</b> Oversigt over pakker<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#principper-med-tidy-data"><i class="fa fa-check"></i><b>5.4</b> Principper med ‘tidy data’<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#lidt-om-tibbles"><i class="fa fa-check"></i><b>5.5</b> Lidt om <code>tibbles</code><span></span></a></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#transition-fra-base-til-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Transition fra base til tidyverse<span></span></a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#om-titanic-datasæt"><i class="fa fa-check"></i><b>5.6.1</b> Om <strong>Titanic</strong> datasæt<span></span></a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#titanic-oprydning"><i class="fa fa-check"></i><b>5.6.2</b> Titanic: oprydning<span></span></a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#pipe"><i class="fa fa-check"></i><b>5.6.3</b> Pipe<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#bearbejdning-af-data-dplyr"><i class="fa fa-check"></i><b>5.7</b> Bearbejdning af data: <code>dplyr</code><span></span></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#dplyr-verbs-select"><i class="fa fa-check"></i><b>5.7.1</b> dplyr verbs: <code>select()</code><span></span></a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#dplyr-verbs-filter"><i class="fa fa-check"></i><b>5.7.2</b> dplyr verbs: <code>filter()</code><span></span></a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#comparitiver-reference"><i class="fa fa-check"></i><b>5.7.3</b> Comparitiver reference<span></span></a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#kombinere-filter-og-select"><i class="fa fa-check"></i><b>5.7.4</b> Kombinere <code>filter()</code> og <code>select()</code><span></span></a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#dplyr-verbs-mutate"><i class="fa fa-check"></i><b>5.7.5</b> dplyr verbs: <code>mutate()</code><span></span></a></li>
<li class="chapter" data-level="5.7.6" data-path="data.html"><a href="data.html#rename"><i class="fa fa-check"></i><b>5.7.6</b> <code>rename()</code><span></span></a></li>
<li class="chapter" data-level="5.7.7" data-path="data.html"><a href="data.html#dplyr-verbs-recode"><i class="fa fa-check"></i><b>5.7.7</b> dplyr verbs: <code>recode()</code><span></span></a></li>
<li class="chapter" data-level="5.7.8" data-path="data.html"><a href="data.html#dplyr-verbs-arrange"><i class="fa fa-check"></i><b>5.7.8</b> dplyr verbs: <code>arrange()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#visualisering-bruge-som-input-i-ggplot2"><i class="fa fa-check"></i><b>5.8</b> Visualisering: bruge som input i ggplot2<span></span></a></li>
<li class="chapter" data-level="5.9" data-path="data.html"><a href="data.html#misc-funktioner-som-er-nyttige-at-vide"><i class="fa fa-check"></i><b>5.9</b> Misc funktioner som er nyttige at vide<span></span></a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data.html"><a href="data.html#pull"><i class="fa fa-check"></i><b>5.9.1</b> Pull<span></span></a></li>
<li class="chapter" data-level="5.9.2" data-path="data.html"><a href="data.html#slice"><i class="fa fa-check"></i><b>5.9.2</b> Slice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data.html"><a href="data.html#problemstillinger-4"><i class="fa fa-check"></i><b>5.10</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="5.11" data-path="data.html"><a href="data.html#kommentarer"><i class="fa fa-check"></i><b>5.11</b> Kommentarer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html"><i class="fa fa-check"></i><b>6</b> Bearbejdning dag 2<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#indledning-og-læringsmålene"><i class="fa fa-check"></i><b>6.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#læringsmålene-1"><i class="fa fa-check"></i><b>6.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#videoer"><i class="fa fa-check"></i><b>6.1.2</b> Videoer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#group_by-med-summarise-i-dplyr-pakken"><i class="fa fa-check"></i><b>6.2</b> <code>group_by()</code> med <code>summarise()</code> i dplyr-pakken<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#reference-af-summarise-funktioner"><i class="fa fa-check"></i><b>6.2.1</b> Reference af <code>summarise()</code> funktioner<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#flere-summary-statistic-på-én-gang"><i class="fa fa-check"></i><b>6.2.2</b> Flere summary statistic på én gang<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#mere-kompliceret-group_by"><i class="fa fa-check"></i><b>6.2.3</b> Mere kompliceret <code>group_by()</code><span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-ungroup"><i class="fa fa-check"></i><b>6.2.4</b> Funktionen <code>ungroup</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#pivot_longerpivot_wider-med-tidyr-pakken"><i class="fa fa-check"></i><b>6.3</b> <code>pivot_longer()</code>/<code>pivot_wider()</code> med Tidyr-pakken<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#tidyr-pakke---oversigt"><i class="fa fa-check"></i><b>6.3.1</b> Tidyr pakke - oversigt<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#wide---long-med-pivot_longer"><i class="fa fa-check"></i><b>6.3.2</b> Wide -&gt; Long med <code>pivot_longer()</code><span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#separate"><i class="fa fa-check"></i><b>6.3.3</b> <code>separate()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#eksempel-titanic-summary-statistics"><i class="fa fa-check"></i><b>6.4</b> Eksempel: Titanic summary statistics<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#demonstration-af-pivot_wider"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration af <code>pivot_wider()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#left_join-forbinde-dataframes"><i class="fa fa-check"></i><b>6.5</b> <code>left_join()</code>: forbinde dataframes<span></span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-left_join-fra-dplyr-pakken"><i class="fa fa-check"></i><b>6.5.1</b> Funktionen <code>left_join()</code> fra dplyr-pakken<span></span></a></li>
<li class="chapter" data-level="6.5.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#anvende-left_join-for-vores-dataset."><i class="fa fa-check"></i><b>6.5.2</b> Anvende <code>left_join()</code> for vores dataset.<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#problemstillinger-5"><i class="fa fa-check"></i><b>6.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="6.7" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#ekstra-links-2"><i class="fa fa-check"></i><b>6.7</b> Ekstra links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html"><i class="fa fa-check"></i><b>7</b> Functional programming med purrr-pakken<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene"><i class="fa fa-check"></i><b>7.1</b> Inledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#læringsmålene-2"><i class="fa fa-check"></i><b>7.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#video-ressourcer-3"><i class="fa fa-check"></i><b>7.1.2</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#iterativ-processer-med-map-fuktioner"><i class="fa fa-check"></i><b>7.2</b> Iterativ processer med <code>map()</code> fuktioner<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner"><i class="fa fa-check"></i><b>7.2.1</b> Introduktion til <code>map()</code> funktioner<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#reference-for-the-different-map-functions"><i class="fa fa-check"></i><b>7.2.2</b> Reference for the different map functions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#custom-fuktioner"><i class="fa fa-check"></i><b>7.3</b> Custom fuktioner<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#simple-functions"><i class="fa fa-check"></i><b>7.3.1</b> Simple functions<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#custom-functions-with-mapping"><i class="fa fa-check"></i><b>7.3.2</b> Custom functions with mapping<span></span></a></li>
<li class="chapter" data-level="7.3.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-data-typer"><i class="fa fa-check"></i><b>7.3.3</b> Effekten af <code>map</code> på andre data typer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#nesting-nest"><i class="fa fa-check"></i><b>7.4</b> Nesting <code>nest()</code><span></span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#anvende-map-med-nested-data"><i class="fa fa-check"></i><b>7.4.1</b> Anvende map() med nested data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr"><i class="fa fa-check"></i><b>7.5</b> Andre brugbar purrr<span></span></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#map2-function-for-flere-inputs"><i class="fa fa-check"></i><b>7.5.1</b> <code>map2()</code> function for flere inputs<span></span></a></li>
<li class="chapter" data-level="7.5.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#transformer-numeriske-variabler"><i class="fa fa-check"></i><b>7.5.2</b> Transformer numeriske variabler<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#problemstillinger-6"><i class="fa fa-check"></i><b>7.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="7.7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang"><i class="fa fa-check"></i><b>7.7</b> Ekstra notater og næste gang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html"><i class="fa fa-check"></i><b>8</b> Visualisering af trends<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#indledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>8.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#læringsmålene-3"><i class="fa fa-check"></i><b>8.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#introduktion-til-chapter"><i class="fa fa-check"></i><b>8.1.2</b> Introduktion til chapter<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#video-ressourcer-4"><i class="fa fa-check"></i><b>8.1.3</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#nest-og-map-eksempel-med-korrelation"><i class="fa fa-check"></i><b>8.2</b> <code>nest()</code> og <code>map()</code>: eksempel med korrelation<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#korrelation-over-flere-datasæt-på-en-gang"><i class="fa fa-check"></i><b>8.2.1</b> Korrelation over flere datasæt på en gang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineær-regression---visualisering"><i class="fa fa-check"></i><b>8.3</b> Lineær regression - visualisering<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineær-trends"><i class="fa fa-check"></i><b>8.3.1</b> Lineær trends<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-lm-trendlinjer"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_smooth()</code>: <code>lm</code> trendlinjer<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-flere-lm-trendlinjer-på-samme-plot"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_smooth()</code>: flere <code>lm</code> trendlinjer på samme plot<span></span></a></li>
<li class="chapter" data-level="8.3.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#trendlinjer-med-methodloess"><i class="fa fa-check"></i><b>8.3.4</b> Trendlinjer med <code>method=="loess"</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#plot-linear-regresion-estimates"><i class="fa fa-check"></i><b>8.4</b> Plot linear regresion estimates<span></span></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anvende-lm-over-nested-datasæt"><i class="fa fa-check"></i><b>8.4.1</b> Anvende <code>lm()</code> over nested datasæt<span></span></a></li>
<li class="chapter" data-level="8.4.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#funktion-glue-for-at-tilføje-labels"><i class="fa fa-check"></i><b>8.4.2</b> Funktion <code>glue()</code> for at tilføje labels<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#multiple-regression-and-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Multiple regression and model comparison<span></span></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anova-for-at-sammenligne-de-forskellige-modeller"><i class="fa fa-check"></i><b>8.5.1</b> <code>anova</code> for at sammenligne de forskellige modeller<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#problemstillinger-7"><i class="fa fa-check"></i><b>8.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="8.7" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#ekstra"><i class="fa fa-check"></i><b>8.7</b> Ekstra<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse og visualisering af biologiske datasæt - 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functional-programming-med-purrr-pakken" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Functional programming med purrr-pakken<a href="functional-programming-med-purrr-pakken.html#functional-programming-med-purrr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="plots/hex-tidyverse.png" width="15%" /><img src="plots/purrr.png" width="15%" /></p>
<div id="inledning-og-læringsmålene" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Inledning og læringsmålene<a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Emnet handler om hvordan man kan inddrage funktioner for at øge reproducebarhed og gennemskuelighed i dine analyser. Det er ofte tilfældet i biologi, at man har flere datasæts eller variabler, der referer fk. til forskellige samples, replikator eller batches, og man gerne vil lave præcis samme proces på dem alle sammen samtidig.</p>
<p>I dette emne beskæftiger du dig med især pakken <code>Purrr</code> og <code>map()</code> funktioner, som kan benyttes til at lave gentagne baserende analyser i <code>R</code>.</p>
<div id="læringsmålene-2" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Læringsmålene<a href="functional-programming-med-purrr-pakken.html#læringsmålene-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I skal være i stand til at:</p>
<ul>
<li>Anvende <code>map()</code> - funktioner til at udføre beregninger iterativt over flere kolonner</li>
<li><code>group_by()</code> og <code>nest()</code> til at lave reproducerbar analyser over forskellige dele af datasættet.</li>
<li>Kombinere <code>map()</code> og <code>map2()</code> med custom funktioner for at øge fleksibilitet i analyserne.</li>
</ul>
</div>
<div id="video-ressourcer-3" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Video ressourcer<a href="functional-programming-med-purrr-pakken.html#video-ressourcer-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Video 1: Introduction to map functions for iterating over columns</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/549630848" class="uri">https://player.vimeo.com/video/549630848</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/549630848" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<ul>
<li>Video 2: Introduction to custom functions and combining them with map</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/549630825" class="uri">https://player.vimeo.com/video/549630825</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/549630825" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<ul>
<li>Video 3: Introduction to nest functions for breaking data into sections</li>
</ul>
<p>Link her hvis det ikke virker nedenunder: <a href="https://player.vimeo.com/video/549630798" class="uri">https://player.vimeo.com/video/549630798</a></p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/549630798" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<ul>
<li>Video 4: Introduction to map2 functions</li>
</ul>
</div>
</div>
<div id="iterativ-processer-med-map-fuktioner" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Iterativ processer med <code>map()</code> fuktioner<a href="functional-programming-med-purrr-pakken.html#iterativ-processer-med-map-fuktioner" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Når man lave en interativ proces, vil man gerne lave samme ting gentagne gange. Det kan være for eksempel, at vi har ti variabler og vi gerne vil beregne middelværdien for hver variable. Vi arbejder med datasættet <code>eukaryotes</code>, som indeholder oplysninger om forskellige organismer som hører til eukaryotes - for eksempel deres navne, gruppe, sub-gruppe, antal proteins/genes, genom størrelse og så videre. Man kan få de data indlæste med følgende kommando og se en list over for de forskellige kolon navne nedenfor.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="functional-programming-med-purrr-pakken.html#cb343-1" aria-hidden="true" tabindex="-1"></a>eukaryotes <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://www.dropbox.com/s/3u4nuj039itzg8l/eukaryotes.tsv?dl=1&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 11508 Columns: 19
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;\t&quot;
## chr  (10): organism_name, bioproject_accession, group, subgroup, assembly_ac...
## dbl   (7): taxid, bioproject_id, size_mb, gc, scaffolds, genes, proteins
## date  (2): release_date, modify_date
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Vi tager udgangspunkt i kun fire variabler, så for at gøre tingene mere overskuelige, har jeg brugt <code>select()</code> til at kun får de fire variabler <code>organism_name</code>,<code>center</code>,<code>group</code> og <code>subgroup</code> i en dataframe</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="functional-programming-med-purrr-pakken.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co">#eukaryotes_full &lt;- eukaryotes</span></span>
<span id="cb345-2"><a href="functional-programming-med-purrr-pakken.html#cb345-2" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="ot">&lt;-</span> eukaryotes <span class="sc">%&gt;%</span> <span class="fu">select</span>(organism_name, center, group, subgroup)</span>
<span id="cb345-3"><a href="functional-programming-med-purrr-pakken.html#cb345-3" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 11,508
## Columns: 4
## $ organism_name &lt;chr&gt; &quot;Pyropia yezoensis&quot;, &quot;Emiliania huxleyi CCMP1516&quot;, &quot;Arab…
## $ center        &lt;chr&gt; &quot;Ocean University&quot;, &quot;JGI&quot;, &quot;The Arabidopsis Information …
## $ group         &lt;chr&gt; &quot;Other&quot;, &quot;Protists&quot;, &quot;Plants&quot;, &quot;Plants&quot;, &quot;Plants&quot;, &quot;Plan…
## $ subgroup      &lt;chr&gt; &quot;Other&quot;, &quot;Other Protists&quot;, &quot;Land Plants&quot;, &quot;Land Plants&quot;,…</code></pre>
<p>Lad os forestille os, at vi gerne vil beregne antallet af unikke organismer (variablen <code>organism_name</code>). Der er en funktion der hedder <code>n_distinct</code> som beregner antallet af unikke værdier i en vector/variable. Her vælger vi <code>organism_name</code> og så tilføjer <code>n_distinct()</code>.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="functional-programming-med-purrr-pakken.html#cb347-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> </span>
<span id="cb347-2"><a href="functional-programming-med-purrr-pakken.html#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(organism_name) <span class="sc">%&gt;%</span> </span>
<span id="cb347-3"><a href="functional-programming-med-purrr-pakken.html#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">n_distinct</span>()</span></code></pre></div>
<pre><code>## [1] 6111</code></pre>
<p>Lad os forestille os, at vi også er interesseret i antallet af unikke værdier i variablerne <code>center</code>, <code>group</code> og <code>subgroup</code> - som er de tre andre kolonner i datasættet. Vi har forskellige muligheder:</p>
<ul>
<li>Skrive dem ud - men hvad nu hvis vi havde 100 variabler at håndtere?</li>
</ul>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="functional-programming-med-purrr-pakken.html#cb349-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">select</span>(organism_name) <span class="sc">%&gt;%</span> <span class="fu">n_distinct</span>()</span>
<span id="cb349-2"><a href="functional-programming-med-purrr-pakken.html#cb349-2" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">select</span>(center) <span class="sc">%&gt;%</span> <span class="fu">n_distinct</span>()</span>
<span id="cb349-3"><a href="functional-programming-med-purrr-pakken.html#cb349-3" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">select</span>(group) <span class="sc">%&gt;%</span> <span class="fu">n_distinct</span>()</span>
<span id="cb349-4"><a href="functional-programming-med-purrr-pakken.html#cb349-4" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">select</span>(subgroup) <span class="sc">%&gt;%</span> <span class="fu">n_distinct</span>()</span></code></pre></div>
<pre><code>## [1] 6111
## [1] 2137
## [1] 5
## [1] 19</code></pre>
<ul>
<li>Vi kræver en mere automatiske løsning på det. Vi bruger ikke tid på det her, men der er den traditionele programmering løsning: for loop, som fungerer også i R:</li>
</ul>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="functional-programming-med-purrr-pakken.html#cb351-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(eukaryotes_subset)</span>
<span id="cb351-2"><a href="functional-programming-med-purrr-pakken.html#cb351-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-3"><a href="functional-programming-med-purrr-pakken.html#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(column_name <span class="cf">in</span> col_names)</span>
<span id="cb351-4"><a href="functional-programming-med-purrr-pakken.html#cb351-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb351-5"><a href="functional-programming-med-purrr-pakken.html#cb351-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(eukaryotes_subset <span class="sc">%&gt;%</span> </span>
<span id="cb351-6"><a href="functional-programming-med-purrr-pakken.html#cb351-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(column_name) <span class="sc">%&gt;%</span> </span>
<span id="cb351-7"><a href="functional-programming-med-purrr-pakken.html#cb351-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">n_distinct</span>())</span>
<span id="cb351-8"><a href="functional-programming-med-purrr-pakken.html#cb351-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Note: Using an external vector in selections is ambiguous.
## ℹ Use `all_of(column_name)` instead of `column_name` to silence this message.
## ℹ See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.
## This message is displayed once per session.</code></pre>
<pre><code>## [1] 6111
## [1] 2137
## [1] 5
## [1] 19</code></pre>
<p>Man i teorien kan holde sig til for loops men jeg vil gerne præsentere den <code>tidyverse</code> løsning, som bliver mere intuitiv og nemmere for ændre at læse koden når man er vant til det (det integrerer også bedre med de andre <code>tidyverse</code> pakker).</p>
<div id="introduktion-til-map-funktioner" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Introduktion til <code>map()</code> funktioner<a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Den <code>tidyverse</code> løsning er såkaldte de <code>map()</code> funktioner, som er en del af pakken <code>purrr</code>. Jeg introducerer dem her frem for de base-R løsninger ikke bare fordi de er <code>tidyverse</code>, men fordi de er en meget fleksibelt og nemt at forstå tilgang, når man vænner sig til dem.</p>
<p>Jeg viser hvordan de fungere igennem <code>eukaryotes</code> og bagefter introducerer dem i konteksten af custom funktioner og <code>nest()</code> som kan bruges til at opdele datasættet indtil forskellige dele (ovenpå hvori man kan gentage samme process).</p>
<p>Man anvender <code>map()</code> ved at angiv funktionen navn <code>n_distinct</code> indenfor <code>map()</code>, og <code>map()</code> beregner <code>n_distinct()</code> for hver kolon i datasættet.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="functional-programming-med-purrr-pakken.html#cb354-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">map</span>(n_distinct) <span class="co">#do &#39;n_distinct&#39; for every single column</span></span></code></pre></div>
<pre><code>## $organism_name
## [1] 6111
## 
## $center
## [1] 2137
## 
## $group
## [1] 5
## 
## $subgroup
## [1] 19</code></pre>
<p>Så kan man se, at vi har fået en <code>list</code> tilbage, med en tal som viser antallet af unikke værdier til hver af de fire kolonner. Det fungerer lidt som den base-R funktion <code>apply</code>, men med <code>apply</code> skal man bruge <code>2</code> i anden plads til at fortælle, at vi gerne vil iterate over kolonnerne.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="functional-programming-med-purrr-pakken.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(eukaryotes_subset,<span class="dv">2</span>,n_distinct)</span></code></pre></div>
<pre><code>## organism_name        center         group      subgroup 
##          6111          2137             5            19</code></pre>
<p>Bemærk at vi har fået her en vector af tal tilbage, men vi fået en <code>list</code> med <code>map</code>. Der er faktisk andre varianter af <code>map</code> som kan benyttes til at give resultatet som andre data typer. For eksempel, kan man bruge <code>map_dbl()</code> til at få en double <code>dbl</code> tilbage - en vector af tal ligesom vi fået med <code>apply</code> i ovenstående.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="functional-programming-med-purrr-pakken.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply n_distinct to all variables, returning a double</span></span>
<span id="cb358-2"><a href="functional-programming-med-purrr-pakken.html#cb358-2" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(n_distinct)</span></code></pre></div>
<pre><code>## organism_name        center         group      subgroup 
##          6111          2137             5            19</code></pre>
<p>Man kan også bruge <code>map_df()</code> for at få en dataramme (<code>tibble</code>) tilbage - det er særligt nyttigt for os, fordi vi tager altid udgangspunkt i en dataramme når vi skal få lavet et plot.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="functional-programming-med-purrr-pakken.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply n_distinct to all variables, returning a dataframe</span></span>
<span id="cb360-2"><a href="functional-programming-med-purrr-pakken.html#cb360-2" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(n_distinct)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   organism_name center group subgroup
##           &lt;int&gt;  &lt;int&gt; &lt;int&gt;    &lt;int&gt;
## 1          6111   2137     5       19</code></pre>
<p>For eksempel, kan man tilføje de tal fra <code>map_df</code> direkte ind i et ggplot.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="functional-programming-med-purrr-pakken.html#cb362-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset <span class="sc">%&gt;%</span> </span>
<span id="cb362-2"><a href="functional-programming-med-purrr-pakken.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(n_distinct) <span class="sc">%&gt;%</span> </span>
<span id="cb362-3"><a href="functional-programming-med-purrr-pakken.html#cb362-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb362-4"><a href="functional-programming-med-purrr-pakken.html#cb362-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> count,<span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb362-5"><a href="functional-programming-med-purrr-pakken.html#cb362-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb362-6"><a href="functional-programming-med-purrr-pakken.html#cb362-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb362-7"><a href="functional-programming-med-purrr-pakken.html#cb362-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-360-1.png" width="480" /></p>
<!-- ### Map funktion med arguments -->
<!-- En ting som er vigtig at husk - hvis man gerne vil tilføje arguments indenfor de funktioner de specificer med `map()` så skal man tilføj `~` som i følgende: -->
<!-- ```{r} -->
<!-- eukaryotes_subset %>% map_df(n_distinct) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- eukaryotes_subset %>% map_df(~.x %>% n_distinct(na.rm=TRUE)) -->
<!-- ``` -->
</div>
<div id="reference-for-the-different-map-functions" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Reference for the different map functions<a href="functional-programming-med-purrr-pakken.html#reference-for-the-different-map-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- ```{r, echo=FALSE,out.height="100%",fig.cap="reference: https://adv-r.hadley.nz/functionals.html"} -->
<!-- # Bigger fig.width -->
<!-- library(png) -->
<!-- library(knitr) -->
<!-- include_graphics("plots/map-list.png") -->
<!-- ``` -->
<table>
<thead>
<tr class="header">
<th>Funktion</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map_lgl()</code></td>
<td>returns a logical</td>
</tr>
<tr class="even">
<td><code>map_int()</code></td>
<td>returns an integer vector</td>
</tr>
<tr class="odd">
<td><code>map_dbl()</code></td>
<td>returns a double vector</td>
</tr>
<tr class="even">
<td><code>map_chr()</code></td>
<td>returns a character vector</td>
</tr>
<tr class="odd">
<td><code>map_df()</code></td>
<td>returns a data frame</td>
</tr>
</tbody>
</table>
<!-- ```{r} -->
<!-- c(1:10) %>% map(~.x) -->
<!-- ``` -->
</div>
</div>
<div id="custom-fuktioner" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Custom fuktioner<a href="functional-programming-med-purrr-pakken.html#custom-fuktioner" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi kan lave vores egne funktioner og betnytter dem indenfor map til at yderligere øge fleksibiliteten i R. For eksempel, kan det være at vi har en bestemt idé overfor, hvordan vi gerne vil normalisere vores data, og der eksisterer ikke en relevant funktion indenfor R i forvejen.</p>
<div id="simple-functions" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Simple functions<a href="functional-programming-med-purrr-pakken.html#simple-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi starter med en simpel funktion fra base-R og så forklare den i den table bagefter. Vi bruger mest en anden form af funktioner i <strong>tidyverse</strong> som vi kigger på næste, men koncepten er den samme.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="functional-programming-med-purrr-pakken.html#cb363-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="cf">function</span>(.x)</span>
<span id="cb363-2"><a href="functional-programming-med-purrr-pakken.html#cb363-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb363-3"><a href="functional-programming-med-purrr-pakken.html#cb363-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(.x)<span class="sc">/</span><span class="fu">length</span>(.x))</span>
<span id="cb363-4"><a href="functional-programming-med-purrr-pakken.html#cb363-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th>Kode</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>my_function_name</code></td>
<td>funktion navn</td>
</tr>
<tr class="even">
<td><code>&lt;- function(.x)</code></td>
<td>fortæl R, at vi lave en funktion med nogle data <code>.x</code></td>
</tr>
<tr class="odd">
<td><code>sum(.x)/length(.x)</code></td>
<td>brug data <code>.x</code> til at beregne middelværdi</td>
</tr>
<tr class="even">
<td><code>return()</code></td>
<td>hvad funktionen skal output - her middelværdi</td>
</tr>
</tbody>
</table>
<p>Lad også afprøve vores nye funccion ved at beregne den gennemsnitlige værdi for <code>Sepal.Length</code> i <code>iris</code>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="functional-programming-med-purrr-pakken.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>(iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb364-2"><a href="functional-programming-med-purrr-pakken.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] 5.843333
## [1] 5.843333</code></pre>
</div>
<div id="custom-functions-with-mapping" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Custom functions with mapping<a href="functional-programming-med-purrr-pakken.html#custom-functions-with-mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Indenfor den <code>tidyverse</code> bruger man en lidt anden måde at skrive samme funktion på.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="functional-programming-med-purrr-pakken.html#cb366-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="er">~</span> <span class="fu">sum</span>(.x)<span class="sc">/</span><span class="fu">length</span>(.x)</span></code></pre></div>
<ul>
<li><code>~</code> betyder at vi definere en funktion</li>
<li><code>.x</code> betyder de data, der vi angiver funktionen (for eksempel variablen <code>Sepal.Length</code> fra <code>iris</code>). Man bruger den symbol <code>.x</code> hver gang og R ved automatiske hvad det betyder.</li>
</ul>
<p>Vi kan bruge <code>my_function</code> indenfor <code>map()</code> for at beregne den gennemsnitlige værdi for alle variabler (uden Species), og vi kan se at vi få tilsvarende resultat til funktionen <code>mean()</code>:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="functional-programming-med-purrr-pakken.html#cb367-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb367-2"><a href="functional-programming-med-purrr-pakken.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span> </span>
<span id="cb367-3"><a href="functional-programming-med-purrr-pakken.html#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(my_function)</span>
<span id="cb367-4"><a href="functional-programming-med-purrr-pakken.html#cb367-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-5"><a href="functional-programming-med-purrr-pakken.html#cb367-5" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb367-6"><a href="functional-programming-med-purrr-pakken.html#cb367-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span> </span>
<span id="cb367-7"><a href="functional-programming-med-purrr-pakken.html#cb367-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(mean)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1         5.84        3.06         3.76        1.20
## # A tibble: 1 × 4
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1         5.84        3.06         3.76        1.20</code></pre>
<p>Man kan også placere funktionen direkte indenfor <code>map_df</code> i stedet for at kalde den for nogle (fk. <code>my_funktion</code>):</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="functional-programming-med-purrr-pakken.html#cb369-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb369-2"><a href="functional-programming-med-purrr-pakken.html#cb369-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb369-3"><a href="functional-programming-med-purrr-pakken.html#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span> <span class="fu">sum</span>(.x)<span class="sc">/</span><span class="fu">length</span>(.x)) <span class="co">#for each data column, compute the sum and divide by the length</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1         5.84        3.06         3.76        1.20</code></pre>
<p>Vi kan godt specificere andre funktioner.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="functional-programming-med-purrr-pakken.html#cb371-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb371-2"><a href="functional-programming-med-purrr-pakken.html#cb371-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">nth</span>(.x,<span class="dv">10</span>)) <span class="co">#tag hver kolon, kalde det for .x og finde 10. værdi</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
## 1          4.9         3.1          1.5         0.1 setosa</code></pre>
<p>eller når <code>nth</code> is a <strong>tidyverse</strong> funktion kan vi bruge <code>%&gt;%</code>:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="functional-programming-med-purrr-pakken.html#cb373-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb373-2"><a href="functional-programming-med-purrr-pakken.html#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">nth</span>(<span class="dv">10</span>)) <span class="co">#tag hver kolon, kalde det for .x og finde 10. værdi</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
## 1          4.9         3.1          1.5         0.1 setosa</code></pre>
<p>Antallet af distinkt værdier som ikke er <code>NA</code>:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="functional-programming-med-purrr-pakken.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tag hver kolon, kalde det for .x og beregne n_distinct</span></span>
<span id="cb375-2"><a href="functional-programming-med-purrr-pakken.html#cb375-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb375-3"><a href="functional-programming-med-purrr-pakken.html#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">n_distinct</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co">#n_dinstict er fra tidyverse</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##          &lt;int&gt;       &lt;int&gt;        &lt;int&gt;       &lt;int&gt;   &lt;int&gt;
## 1           35          23           43          22       3</code></pre>
<p>Bemærk at hvis det er en indbygget funktion og vi benytter default parametre (altså na.rm = FALSE i ovenstående) kan man bare skrive:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="functional-programming-med-purrr-pakken.html#cb377-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb377-2"><a href="functional-programming-med-purrr-pakken.html#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(n_distinct)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##          &lt;int&gt;       &lt;int&gt;        &lt;int&gt;       &lt;int&gt;   &lt;int&gt;
## 1           35          23           43          22       3</code></pre>
<p>Et andet eksempel: tilføje 3 og square:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="functional-programming-med-purrr-pakken.html#cb379-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb379-2"><a href="functional-programming-med-purrr-pakken.html#cb379-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb379-3"><a href="functional-programming-med-purrr-pakken.html#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span>(.x <span class="sc">+</span> <span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1         65.6        42.2         19.4        10.2
## 2         62.4        36           19.4        10.2
## 3         59.3        38.4         18.5        10.2
## 4         57.8        37.2         20.2        10.2
## 5         64          43.6         19.4        10.2
## 6         70.6        47.6         22.1        11.6</code></pre>
<p>Jo mere funktionen bliver indviklet, jo mere mening det giver at specificere den udenfor den <code>map()</code> funktion:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="functional-programming-med-purrr-pakken.html#cb381-1" aria-hidden="true" tabindex="-1"></a>my_function <span class="ot">&lt;-</span> <span class="er">~</span>(.x <span class="sc">-</span> <span class="fu">mean</span>(.x))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>(.x <span class="sc">-</span> <span class="fu">sd</span>(.x))<span class="sc">^</span><span class="dv">2</span> <span class="co">#a long pointless function</span></span>
<span id="cb381-2"><a href="functional-programming-med-purrr-pakken.html#cb381-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-3"><a href="functional-programming-med-purrr-pakken.html#cb381-3" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb381-4"><a href="functional-programming-med-purrr-pakken.html#cb381-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb381-5"><a href="functional-programming-med-purrr-pakken.html#cb381-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(my_function) <span class="co">#beregne my_function for hver kolon og output en dataramme </span></span></code></pre></div>
<pre><code>## # A tibble: 150 × 4
##    Sepal.Length Sepal.Width Petal.Length Petal.Width
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1         9.68        4.89         5.63       1.16 
##  2         9.18        3.29         5.63       1.16 
##  3         8.80        3.84         6.15       1.16 
##  4         8.66        3.55         5.13       1.16 
##  5         9.41        5.30         5.63       1.16 
##  6        10.6         6.71         4.24       0.705
##  7         8.66        4.51         5.63       0.916
##  8         9.41        4.51         5.13       1.16 
##  9         8.46        3.06         5.63       1.16 
## 10         9.18        3.55         5.13       1.43 
## # … with 140 more rows</code></pre>
</div>
<div id="effekten-af-map-på-andre-data-typer" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Effekten af <code>map</code> på andre data typer<a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-data-typer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I ovenstående fokuser jeg på <code>map</code> i forhold til dataframes. I <code>group_by</code> + <code>nest</code> i nedenstående anvender man <code>map()</code> på en list af dataframes, der hedder <code>data</code>, der tillader os at arbejde med datasæt hvert for sig. Det er derfor værd at tage lidt tid på at se hvordan <code>map()</code> behandler forskellige data typer.</p>
<p><strong>input: vector</strong></p>
<ul>
<li><code>.x</code> referes til en værdi i vectoren. Hvis man tager integer <code>1:10</code> og anvender map, så tager man hvert tal hver for sig og beregner en funktion med det - i følgende simulere man et tal fra den normale fordeling med indstillingen <code>mean=.x</code>:</li>
</ul>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="functional-programming-med-purrr-pakken.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="sc">~</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>.x))</span></code></pre></div>
<pre><code>##  [1]  1.982341  1.460212  5.566752  4.225571  6.115275  5.748129  9.289555
##  [8]  7.149355  7.900811 11.354384</code></pre>
<p><strong>input: dataframe</strong></p>
<ul>
<li><code>.x</code> refereres til en variable fra dataframe. I ovenståene er første variable <code>int1</code> og i map tager man den første element med funktionen <code>pluck(1)</code>.</li>
</ul>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="functional-programming-med-purrr-pakken.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">&quot;int1&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="st">&quot;int2&quot;</span><span class="ot">=</span><span class="dv">21</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## $int1
## [1] 1
## 
## $int2
## [1] 21</code></pre>
<p>Med nest kigger vi på den mulighed vore man laver map over en list, som bliver lavet med funktionen <code>nest()</code>.</p>
<p><strong>input: list</strong></p>
<ul>
<li><code>.x</code> referes til et list element - i nedenstående er den første element <code>c(1,2)</code> så hvis man anvender funktionen <code>max</code> så tager man maksimum værdi (<code>2</code> i dette tilfælde).</li>
</ul>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="functional-programming-med-purrr-pakken.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">max</span>(.x))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 4</code></pre>
<p>Bemærk at der der kommer kun et tal som resultat, kan man <code>map_dbl</code> i stedet for <code>map</code> - så får man en vector som outputtet, selvom inputtet er en list.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="functional-programming-med-purrr-pakken.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="sc">~</span><span class="fu">max</span>(.x))</span></code></pre></div>
<pre><code>## [1] 2 3 4</code></pre>
<p><strong>list af dataframe</strong></p>
<ul>
<li><code>.x</code> referes til et datasæt - så kan man referer til de forskellige variabler i <code>.x</code> som man plejer i tidyverse.</li>
</ul>
<p>Følgende er ligesom i tilfælde med koncepten “nesting” i næste sektion. Man tager en list af tibbles og vælger det første tal fra variablen <code>int</code>.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="functional-programming-med-purrr-pakken.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">tibble</span>(<span class="st">&quot;int&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="fu">tibble</span>(<span class="st">&quot;int&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="fu">tibble</span>(<span class="st">&quot;int&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb391-2"><a href="functional-programming-med-purrr-pakken.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_int</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;int&quot;</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 1 1 1</code></pre>
</div>
</div>
<div id="nesting-nest" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Nesting <code>nest()</code><a href="functional-programming-med-purrr-pakken.html#nesting-nest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi kommer til at se i næste lektion, at det er meget nyttige at bruge funktionen <code>nest()</code> for at få svar på adskillige statistiske spørgsmål. Det kan være for eksempel:</p>
<ul>
<li>Vi har lavet 10 eksperimental under lidt forskellige konditioner, og gerne vil lave præcis samme analyse på alle 10.</li>
<li>Vi har 5 forskellige type bakterier med 3 replikater til hver, og gerne vil transformere de data på samme måde efter bakterien og replikat.</li>
</ul>
<p>Funktionen <code>nest()</code> kan virke lidt abstract i starten men koncepten er faktisk ret simpelt. Vi kan opelde vores datasæt (som indeholder vores forskellige konditioner/replikats etc.) med <code>group_by()</code> og så bruge <code>nest()</code> til at gemme de opdelt “sub” datasæt i en list. De bliver gemt indenfor en kolon i en <code>tibble</code>, og det gøre det bekvemt at arbejde med de forskellige datasæt på samme tid (med hjælp af <code>map()</code>).</p>
<p><img src="plots/tidyr-nest.png" width="100%" /></p>
<p>Lad os opdele <code>eurkaryotes_subset</code> efter variablen ‘group’ og anvende <code>nest()</code>:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="functional-programming-med-purrr-pakken.html#cb393-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset_nested <span class="ot">&lt;-</span> eukaryotes_subset <span class="sc">%&gt;%</span> </span>
<span id="cb393-2"><a href="functional-programming-med-purrr-pakken.html#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb393-3"><a href="functional-programming-med-purrr-pakken.html#cb393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>()</span>
<span id="cb393-4"><a href="functional-programming-med-purrr-pakken.html#cb393-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-5"><a href="functional-programming-med-purrr-pakken.html#cb393-5" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset_nested</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
## # Groups:   group [5]
##   group    data                
##   &lt;chr&gt;    &lt;list&gt;              
## 1 Other    &lt;tibble [51 × 3]&gt;   
## 2 Protists &lt;tibble [888 × 3]&gt;  
## 3 Plants   &lt;tibble [1,304 × 3]&gt;
## 4 Fungi    &lt;tibble [6,064 × 3]&gt;
## 5 Animals  &lt;tibble [3,201 × 3]&gt;</code></pre>
<p>Vi kan se at vi har to variabler - <code>group</code> og <code>data</code>. Variablen <code>data</code> er indeholde faktisk fem dataramme (tibble), for eksempel den første datasæt har kun observationerne hvor <code>group</code> er lig med “Other,” den anden dataset har kun observationerne hvor <code>group</code> er lig med “Protists” osv.</p>
<p>Vi kan tjekke ved at kig på den første datasæt: her er to måder at gøre det på:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="functional-programming-med-purrr-pakken.html#cb395-1" aria-hidden="true" tabindex="-1"></a>first_dataset <span class="ot">&lt;-</span> eukaryotes_subset_nested<span class="sc">$</span>data[[<span class="dv">1</span>]] </span>
<span id="cb395-2"><a href="functional-programming-med-purrr-pakken.html#cb395-2" aria-hidden="true" tabindex="-1"></a>first_dataset <span class="ot">&lt;-</span> eukaryotes_subset_nested <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;data&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb395-3"><a href="functional-programming-med-purrr-pakken.html#cb395-3" aria-hidden="true" tabindex="-1"></a>first_dataset <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   organism_name                         center                          subgroup
##   &lt;chr&gt;                                 &lt;chr&gt;                           &lt;chr&gt;   
## 1 Pyropia yezoensis                     Ocean University                Other   
## 2 Thalassiosira pseudonana CCMP1335     Diatom Consortium               Other   
## 3 Guillardia theta CCMP2712             JGI                             Other   
## 4 Cyanidioschyzon merolae strain 10D    National Institute of Genetics… Other   
## 5 Galdieria sulphuraria                 Galdieria sulphuraria Genome P… Other   
## 6 Phaeodactylum tricornutum CCAP 1055/1 Diatom Consortium               Other</code></pre>
<p>Hvis vi gerne vil tilbage til vores oprindeligt datasæt, kan vi brug <code>unnest()</code> og specificer kolonnen <code>data</code>:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="functional-programming-med-purrr-pakken.html#cb397-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset_nested <span class="sc">%&gt;%</span> </span>
<span id="cb397-2"><a href="functional-programming-med-purrr-pakken.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb397-3"><a href="functional-programming-med-purrr-pakken.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   group [1]
##   group organism_name                         center                    subgroup
##   &lt;chr&gt; &lt;chr&gt;                                 &lt;chr&gt;                     &lt;chr&gt;   
## 1 Other Pyropia yezoensis                     Ocean University          Other   
## 2 Other Thalassiosira pseudonana CCMP1335     Diatom Consortium         Other   
## 3 Other Guillardia theta CCMP2712             JGI                       Other   
## 4 Other Cyanidioschyzon merolae strain 10D    National Institute of Ge… Other   
## 5 Other Galdieria sulphuraria                 Galdieria sulphuraria Ge… Other   
## 6 Other Phaeodactylum tricornutum CCAP 1055/1 Diatom Consortium         Other</code></pre>
<p>Spørgsmålet er: hvordan kan vi inddrage “nested” data indenfor vores analyser?</p>
<div id="anvende-map-med-nested-data" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Anvende map() med nested data<a href="functional-programming-med-purrr-pakken.html#anvende-map-med-nested-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>De fleste gange vi arbejder med nested data, er fordi vi gerne vil lave samme ting på hver af de “sub” datasæt. Derfor hænger det sammen med funktionen <code>map()</code>. Den typiske process er:</p>
<ul>
<li>Tag nested datasæt</li>
<li>Tilføj en ny kolon med <code>mutate()</code>, hvor vi:</li>
<li>Tag hver datasæt fra kolonnen <code>data</code> og brug <code>map()</code>, i nedenstående tilfælde til at finde antallet af rækkerne.</li>
</ul>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="functional-programming-med-purrr-pakken.html#cb399-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset_nested <span class="sc">%&gt;%</span> </span>
<span id="cb399-2"><a href="functional-programming-med-purrr-pakken.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_row =</span> <span class="fu">map_dbl</span>(data,nrow))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
## # Groups:   group [5]
##   group    data                 n_row
##   &lt;chr&gt;    &lt;list&gt;               &lt;dbl&gt;
## 1 Other    &lt;tibble [51 × 3]&gt;       51
## 2 Protists &lt;tibble [888 × 3]&gt;     888
## 3 Plants   &lt;tibble [1,304 × 3]&gt;  1304
## 4 Fungi    &lt;tibble [6,064 × 3]&gt;  6064
## 5 Animals  &lt;tibble [3,201 × 3]&gt;  3201</code></pre>
<p>Vi kan også bruge en custom funktion. I nedenstående beregne man antallet af unikke organisme fra variablen <code>orangism_name</code> i datasættet. Husk:</p>
<ul>
<li><code>~</code> betyder at vi lave en funktion, som kommer til at fungere for alle de fem datasæt.</li>
<li>Tag et datasæt og kalde det for <code>.x</code> - det referer til en bestemt datasæt fra en af de fem datasæt som hører under kolonnen <code>data</code> i den <code>nest()</code> data.</li>
<li>Vælg variablen <code>organism_name</code> fra <code>.x</code></li>
<li>Beregn <code>n_dinstinct</code></li>
</ul>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="functional-programming-med-purrr-pakken.html#cb401-1" aria-hidden="true" tabindex="-1"></a>n_distinct_organisms <span class="ot">&lt;-</span> <span class="er">~</span> .x <span class="sc">%&gt;%</span> <span class="co">#take data</span></span>
<span id="cb401-2"><a href="functional-programming-med-purrr-pakken.html#cb401-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(organism_name) <span class="sc">%&gt;%</span>  <span class="co">#select organism name</span></span>
<span id="cb401-3"><a href="functional-programming-med-purrr-pakken.html#cb401-3" aria-hidden="true" tabindex="-1"></a>  n_distinct <span class="co">#give back distinct</span></span></code></pre></div>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="functional-programming-med-purrr-pakken.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co">#repeat function for each of the five datasets:</span></span>
<span id="cb402-2"><a href="functional-programming-med-purrr-pakken.html#cb402-2" aria-hidden="true" tabindex="-1"></a>eukaryotes_subset_nested <span class="sc">%&gt;%</span> </span>
<span id="cb402-3"><a href="functional-programming-med-purrr-pakken.html#cb402-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_organisms =</span> <span class="fu">map_dbl</span>(data, n_distinct_organisms))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
## # Groups:   group [5]
##   group    data                 n_organisms
##   &lt;chr&gt;    &lt;list&gt;                     &lt;dbl&gt;
## 1 Other    &lt;tibble [51 × 3]&gt;             35
## 2 Protists &lt;tibble [888 × 3]&gt;           490
## 3 Plants   &lt;tibble [1,304 × 3]&gt;         673
## 4 Fungi    &lt;tibble [6,064 × 3]&gt;        2926
## 5 Animals  &lt;tibble [3,201 × 3]&gt;        1987</code></pre>
<p>Her er en anden eksempel. Her handler det om de <code>eukaryotes</code> data (ikke den subset), som har oplysninger om fk. GC-content med variablen <code>gc</code>. Her bruger vi <code>pull</code> i stedet for <code>select</code> - det er næsten den samme men med <code>pull()</code> få vi en vector som fungerer med <code>median</code> som er en base-R funktion.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="functional-programming-med-purrr-pakken.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># func_gc &lt;- ~ .x %&gt;% </span></span>
<span id="cb404-2"><a href="functional-programming-med-purrr-pakken.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   pull(gc) %&gt;%       # ligesom select men vi har bruge for en vector for at beregne median</span></span>
<span id="cb404-3"><a href="functional-programming-med-purrr-pakken.html#cb404-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   median(.x,na.rm=T) # `na.rm` fjerne `NA` værdier)</span></span>
<span id="cb404-4"><a href="functional-programming-med-purrr-pakken.html#cb404-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-5"><a href="functional-programming-med-purrr-pakken.html#cb404-5" aria-hidden="true" tabindex="-1"></a>func_gc <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">median</span>(.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gc),<span class="at">na.rm=</span>T) </span>
<span id="cb404-6"><a href="functional-programming-med-purrr-pakken.html#cb404-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-7"><a href="functional-programming-med-purrr-pakken.html#cb404-7" aria-hidden="true" tabindex="-1"></a>ekaryotes_gc_by_group <span class="ot">&lt;-</span> eukaryotes <span class="sc">%&gt;%</span> </span>
<span id="cb404-8"><a href="functional-programming-med-purrr-pakken.html#cb404-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb404-9"><a href="functional-programming-med-purrr-pakken.html#cb404-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb404-10"><a href="functional-programming-med-purrr-pakken.html#cb404-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;median_gc&quot;</span><span class="ot">=</span><span class="fu">map_dbl</span>(data, func_gc))</span>
<span id="cb404-11"><a href="functional-programming-med-purrr-pakken.html#cb404-11" aria-hidden="true" tabindex="-1"></a>ekaryotes_gc_by_group</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
## # Groups:   group [5]
##   group    data                  median_gc
##   &lt;chr&gt;    &lt;list&gt;                    &lt;dbl&gt;
## 1 Other    &lt;tibble [51 × 18]&gt;         46.7
## 2 Protists &lt;tibble [888 × 18]&gt;        49.4
## 3 Plants   &lt;tibble [1,304 × 18]&gt;      37.9
## 4 Fungi    &lt;tibble [6,064 × 18]&gt;      47.5
## 5 Animals  &lt;tibble [3,201 × 18]&gt;      40.6</code></pre>
<p>Og jeg kan bruge resultatet ind i et plot ligesom vi plejer:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="functional-programming-med-purrr-pakken.html#cb406-1" aria-hidden="true" tabindex="-1"></a>ekaryotes_gc_by_group <span class="sc">%&gt;%</span> </span>
<span id="cb406-2"><a href="functional-programming-med-purrr-pakken.html#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>group,<span class="at">y=</span>median_gc,<span class="at">fill=</span>group)) <span class="sc">+</span> </span>
<span id="cb406-3"><a href="functional-programming-med-purrr-pakken.html#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb406-4"><a href="functional-programming-med-purrr-pakken.html#cb406-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb406-5"><a href="functional-programming-med-purrr-pakken.html#cb406-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-385-1.png" width="384" /></p>
<p><strong>flere statistik på en gang</strong></p>
<p>Lave funktionerne:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="functional-programming-med-purrr-pakken.html#cb407-1" aria-hidden="true" tabindex="-1"></a>func_genes <span class="ot">&lt;-</span>       <span class="er">~</span><span class="fu">median</span>(.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(genes),   <span class="at">na.rm=</span>T) </span>
<span id="cb407-2"><a href="functional-programming-med-purrr-pakken.html#cb407-2" aria-hidden="true" tabindex="-1"></a>func_proteins <span class="ot">&lt;-</span>    <span class="er">~</span><span class="fu">median</span>(.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(proteins),<span class="at">na.rm=</span>T) </span>
<span id="cb407-3"><a href="functional-programming-med-purrr-pakken.html#cb407-3" aria-hidden="true" tabindex="-1"></a>func_size <span class="ot">&lt;-</span>        <span class="er">~</span><span class="fu">median</span>(.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(size_mb), <span class="at">na.rm=</span>T) </span></code></pre></div>
<p>Anvende <code>nest()</code>:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="functional-programming-med-purrr-pakken.html#cb408-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_nested <span class="ot">&lt;-</span> eukaryotes <span class="sc">%&gt;%</span> </span>
<span id="cb408-2"><a href="functional-programming-med-purrr-pakken.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb408-3"><a href="functional-programming-med-purrr-pakken.html#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() </span></code></pre></div>
<p>Tilføje resultatet over de fem datasæt med <code>mutate()</code>:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="functional-programming-med-purrr-pakken.html#cb409-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_stats <span class="ot">&lt;-</span> eukaryotes_nested <span class="sc">%&gt;%</span></span>
<span id="cb409-2"><a href="functional-programming-med-purrr-pakken.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_genes =</span> <span class="fu">map_dbl</span>(data,func_genes),</span>
<span id="cb409-3"><a href="functional-programming-med-purrr-pakken.html#cb409-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">proteins =</span> <span class="fu">map_dbl</span>(data,func_proteins),</span>
<span id="cb409-4"><a href="functional-programming-med-purrr-pakken.html#cb409-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_size_mb =</span> <span class="fu">map_dbl</span>(data,func_size))</span></code></pre></div>
<p>Husk at fjerne kolonnen <code>data</code> før man anvende <code>pivot_longer()</code> (ellers får man en advarsel):</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="functional-programming-med-purrr-pakken.html#cb410-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_stats <span class="sc">%&gt;%</span> </span>
<span id="cb410-2"><a href="functional-programming-med-purrr-pakken.html#cb410-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data) <span class="sc">%&gt;%</span></span>
<span id="cb410-3"><a href="functional-programming-med-purrr-pakken.html#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>group) <span class="sc">%&gt;%</span></span>
<span id="cb410-4"><a href="functional-programming-med-purrr-pakken.html#cb410-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>group,<span class="at">y=</span>value,<span class="at">fill=</span>group)) <span class="sc">+</span> </span>
<span id="cb410-5"><a href="functional-programming-med-purrr-pakken.html#cb410-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb410-6"><a href="functional-programming-med-purrr-pakken.html#cb410-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>,<span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb410-7"><a href="functional-programming-med-purrr-pakken.html#cb410-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-389-1.png" width="768" /></p>
</div>
</div>
<div id="andre-brugbar-purrr" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Andre brugbar purrr<a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="map2-function-for-flere-inputs" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> <code>map2()</code> function for flere inputs<a href="functional-programming-med-purrr-pakken.html#map2-function-for-flere-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funktionen <code>map2()</code> kan bruges ligesom <code>map()</code> men tager 2 “input” i stedet for kun én. I følgende eksempel angiver jeg to kolonner fra datasættet <code>eukaryotes_stats</code>, <code>mean_genes</code> og <code>proteins</code> og beregner <code>sum</code>, som bliver lagret takket være funktionen <code>mutate</code> som colstat.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="functional-programming-med-purrr-pakken.html#cb411-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_stats <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">colstat =</span> <span class="fu">map2_dbl</span>(mean_genes,proteins,sum))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 6
## # Groups:   group [5]
##   group    data                  mean_genes proteins mean_size_mb colstat
##   &lt;chr&gt;    &lt;list&gt;                     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;
## 1 Other    &lt;tibble [51 × 18]&gt;        11354.   11240.         49.7  22594 
## 2 Protists &lt;tibble [888 × 18]&gt;        8813     8628.         33.5  17442.
## 3 Plants   &lt;tibble [1,304 × 18]&gt;     33146.   37660         358.   70806.
## 4 Fungi    &lt;tibble [6,064 × 18]&gt;     10069    10034          32.2  20103 
## 5 Animals  &lt;tibble [3,201 × 18]&gt;     20733    25161         692.   45894</code></pre>
<p>Bemærk at præcis samme resultat kan fås ved at bare lægger de to kolonner sammen:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="functional-programming-med-purrr-pakken.html#cb413-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_stats <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">colstat2 =</span> mean_genes <span class="sc">+</span> proteins)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 6
## # Groups:   group [5]
##   group    data                  mean_genes proteins mean_size_mb colstat2
##   &lt;chr&gt;    &lt;list&gt;                     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
## 1 Other    &lt;tibble [51 × 18]&gt;        11354.   11240.         49.7   22594 
## 2 Protists &lt;tibble [888 × 18]&gt;        8813     8628.         33.5   17442.
## 3 Plants   &lt;tibble [1,304 × 18]&gt;     33146.   37660         358.    70806.
## 4 Fungi    &lt;tibble [6,064 × 18]&gt;     10069    10034          32.2   20103 
## 5 Animals  &lt;tibble [3,201 × 18]&gt;     20733    25161         692.    45894</code></pre>
<p>Der er dog mange mere indviklet situationer hvor man ikke kan gå udenom <code>map2</code>:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="functional-programming-med-purrr-pakken.html#cb415-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_stats_with_plots <span class="ot">&lt;-</span> eukaryotes_stats <span class="sc">%&gt;%</span> </span>
<span id="cb415-2"><a href="functional-programming-med-purrr-pakken.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log10_genes =</span> <span class="fu">map</span>(data,<span class="sc">~</span><span class="fu">log10</span>(.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(genes)))) <span class="sc">%&gt;%</span> </span>
<span id="cb415-3"><a href="functional-programming-med-purrr-pakken.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">myplots =</span> <span class="fu">map2</span>(group,log10_genes,</span>
<span id="cb415-4"><a href="functional-programming-med-purrr-pakken.html#cb415-4" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">~</span> <span class="fu">tibble</span>(<span class="st">&quot;log10_genes&quot;</span><span class="ot">=</span>.y) <span class="sc">%&gt;%</span> </span>
<span id="cb415-5"><a href="functional-programming-med-purrr-pakken.html#cb415-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>log10_genes)) <span class="sc">+</span></span>
<span id="cb415-6"><a href="functional-programming-med-purrr-pakken.html#cb415-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">geom_density</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>,<span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb415-7"><a href="functional-programming-med-purrr-pakken.html#cb415-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;Density plot of log10(genes) in&quot;</span>,.x))))</span></code></pre></div>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="functional-programming-med-purrr-pakken.html#cb416-1" aria-hidden="true" tabindex="-1"></a>eukaryotes_stats_with_plots <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&quot;myplots&quot;</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 613 rows containing non-finite values (stat_density).</code></pre>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-393-1.png" width="384" /></p>
<p>Der er flere <code>map</code> funktion der tager flere <code>input</code> fk. <code>pmap</code> - jeg har ikke tid til at dække dem men du kan godt læse om dem hvis du har bruge for dem: <a href="https://purrr.tidyverse.org/reference/map2.html" class="uri">https://purrr.tidyverse.org/reference/map2.html</a></p>
</div>
<div id="transformer-numeriske-variabler" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Transformer numeriske variabler<a href="functional-programming-med-purrr-pakken.html#transformer-numeriske-variabler" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Som sidste bemærk, her er en brugbar variant af <code>map</code> - her kan man lave noget på kun bestemte variabler - for eksempel i følgende anvender jeg funktionen <code>log2()</code> på alle numeriske variabler. Bemærk at man er nødt til at anvende <code>as_tibble()</code> igen bagefter (som kun fungerere hvis alle variabler har stadig samme længde efter <code>map_if()</code>):</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="functional-programming-med-purrr-pakken.html#cb418-1" aria-hidden="true" tabindex="-1"></a>eukaryotes <span class="sc">%&gt;%</span> <span class="fu">map_if</span>(is.numeric,<span class="sc">~</span><span class="fu">log2</span>(.x)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>## # A tibble: 11,508 × 19
##    organism_name     taxid bioproject_acce… bioproject_id group subgroup size_mb
##    &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1 Pyropia yezoensis  11.4 PRJNA589917              19.2  Other Other       6.75
##  2 Emiliania huxley…  18.1 PRJNA77753               16.2  Prot… Other P…    7.39
##  3 Arabidopsis thal…  11.9 PRJNA10719               13.4  Plan… Land Pl…    6.90
##  4 Glycine max        11.9 PRJNA19861               14.3  Plan… Land Pl…    9.94
##  5 Medicago truncat…  11.9 PRJNA10791               13.4  Plan… Land Pl…    8.69
##  6 Solanum lycopers…  12.0 PRJNA119                  6.89 Plan… Land Pl…    9.69
##  7 Hordeum vulgare …  16.8 PRJEB34217               19.1  Plan… Land Pl…   12.1 
##  8 Oryza sativa Jap…  15.3 PRJNA12269               13.6  Plan… Land Pl…    8.55
##  9 Triticum aestivum  12.2 PRJNA392179              18.6  Plan… Land Pl…   13.9 
## 10 Zea mays           12.2 PRJNA10769               13.4  Plan… Land Pl…   11.1 
## # … with 11,498 more rows, and 12 more variables: gc &lt;dbl&gt;,
## #   assembly_accession &lt;chr&gt;, replicons &lt;chr&gt;, wgs &lt;chr&gt;, scaffolds &lt;dbl&gt;,
## #   genes &lt;dbl&gt;, proteins &lt;dbl&gt;, release_date &lt;date&gt;, modify_date &lt;date&gt;,
## #   status &lt;chr&gt;, center &lt;chr&gt;, biosample_accession &lt;chr&gt;</code></pre>
</div>
</div>
<div id="problemstillinger-6" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Problemstillinger<a href="functional-programming-med-purrr-pakken.html#problemstillinger-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Problem 1)</strong> Lave Quiz på Absalon “Quiz - functional programming”</p>
<hr />
<p><strong>Problem 2)</strong> <em><code>map()</code> øvelse</em></p>
<p>Eksempel:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="functional-programming-med-purrr-pakken.html#cb420-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">select</span>(cut,color,depth) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(n_distinct)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##     cut color depth
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     5     7   184</code></pre>
<p>Husk også referencen med de forskellige varianter af <code>map()</code> som kan bruges for at få en anden output type.</p>
<p>Indlæse <code>diamonds</code> med <code>data(diamonds)</code>. Brug <code>map()</code> funktioner til at beregne følgende:</p>
<p><strong>a)</strong> Select variabler <code>cut</code>, <code>color</code> og <code>clarity</code> og beregne antallet af distinkt værdier til hver (anvende funktionen <code>n_distinct</code>). Resultatet skulle være en list (anvende deault <code>map()</code> funktion).</p>
<p><strong>b)</strong> Select variabler som er numeriske og beregne den median værdi til hver. Resultatet skal være en double.</p>
<p><strong>c)</strong> Brug alle variabler og return de datatyper (funktion en <code>typeof</code>). Resultatet skal være en dataramme.</p>
<hr />
<p><strong>Problem 3</strong>) <em><code>map()</code> øvelse med custom funktioner</em></p>
<p>Indlæse <code>diamonds</code> med <code>data(diamonds)</code>.</p>
<p>Husk at når man inddrager nogle data <code>.x</code>, for eksempel når man vil bruge en custom funktion eller specificer non-default indstillinger såsom <code>na.rm=TRUE</code> (for at fjerne <code>NA</code> værdier i beregningen) i funktionen, skal man angiv <code>~</code> i starten:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="functional-programming-med-purrr-pakken.html#cb422-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(n_distinct) <span class="co">#specificere funktion unden instillinger</span></span>
<span id="cb422-2"><a href="functional-programming-med-purrr-pakken.html#cb422-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">n_distinct</span>(.x,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co">#custom funktion</span></span></code></pre></div>
<p><strong>a</strong>) Afprøve følgende kode linjer og beskrive hvad der sker.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="functional-programming-med-purrr-pakken.html#cb423-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">select</span>(carat, depth, price) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">mean</span>(.x,<span class="at">na.rm=</span>T))</span>
<span id="cb423-2"><a href="functional-programming-med-purrr-pakken.html#cb423-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cut<span class="sc">==</span><span class="st">&quot;Ideal&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">&quot;color&quot;</span>,<span class="st">&quot;clarity&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">nth</span>(.x,<span class="dv">100</span>))</span>
<span id="cb423-3"><a href="functional-programming-med-purrr-pakken.html#cb423-3" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">select</span>(carat, depth, price) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">&gt;</span><span class="fu">mean</span>(.x),<span class="st">&quot;big_value&quot;</span>,<span class="st">&quot;small_value&quot;</span>))</span></code></pre></div>
<p>Brug custom funktioner indenfor <code>map()</code> til at beregne følgende:</p>
<ul>
<li>Udvælg variabler <code>carat</code>, <code>depth</code>, <code>table</code> og <code>price</code> og for hver kolonne tilføj tre og så dernæst tag square (<code>^2</code>). Resultatet skal være en dataramme.</li>
<li>Udvælg numeriske variabler og angiv <code>TRUE</code> hvis den først værdi i kolonnen (betegnet med <code>nth(.x,1)</code>) er større en den median værdi i kolonnen, ellers <code>FALSE</code>. Resultatet skal være en logical.</li>
</ul>
<hr />
<p><strong>Problem 4)</strong> <em>map på forskellige datatyper</em></p>
<p>Vi har set, at når vi kører <code>map</code> på en dataframe, laver man en funktion over hver kolonne. Lad os se hvad der forgår hvis man har andre datatyper:</p>
<p><strong>a</strong>) (<em>En vector af tal</em>)</p>
<ul>
<li>Kør følgende - hvad sker der?</li>
</ul>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="functional-programming-med-purrr-pakken.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="sc">~</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>.x,<span class="at">sd=</span><span class="dv">1</span>))</span></code></pre></div>
<ul>
<li>Tag udangspunkt i <code>c(1:10)</code> og anvend <code>map_dbl</code> til at beregne den <code>log()</code> af hvert tal i vektoren (angiv indstillingen <code>base=5</code>):</li>
</ul>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="functional-programming-med-purrr-pakken.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> ???</span></code></pre></div>
<p><strong>b</strong>) (<em>En list af tibbles</em>)</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="functional-programming-med-purrr-pakken.html#cb426-1" aria-hidden="true" tabindex="-1"></a>my_list_of_tibbles <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="fu">tibble</span>(<span class="st">&quot;letter&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>), <span class="st">&quot;number&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb426-2"><a href="functional-programming-med-purrr-pakken.html#cb426-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">tibble</span>(<span class="st">&quot;letter&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="st">&quot;number&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>)),</span>
<span id="cb426-3"><a href="functional-programming-med-purrr-pakken.html#cb426-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">tibble</span>(<span class="st">&quot;letter&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>), <span class="st">&quot;number&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">3</span>)))</span></code></pre></div>
<ul>
<li>Kør følgende kode, der tager den første <code>tibble</code> udvælger observationer hvor <code>letter</code> = “a” og dernæst beregner den middelværdi af “number.”</li>
</ul>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="functional-programming-med-purrr-pakken.html#cb427-1" aria-hidden="true" tabindex="-1"></a>my_list_of_tibbles <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(letter<span class="sc">==</span><span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mn =</span> <span class="fu">mean</span>(number))</span></code></pre></div>
<ul>
<li>Nu at jeg kan se, at min kode virker til den første <code>tibble</code>, kan jeg ændre den til en funktion og anvende den med <code>map()</code> til at lave samme process på alle dataframes - prøve at køre følgende.</li>
</ul>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="functional-programming-med-purrr-pakken.html#cb428-1" aria-hidden="true" tabindex="-1"></a>my_list_of_tibbles <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">filter</span>(letter<span class="sc">==</span><span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mn =</span> <span class="fu">mean</span>(number)))</span></code></pre></div>
<ul>
<li>Tag udgangspunkt i <code>my_list_of_tibbles</code> og for hver tibble select alle tilfælde hvor variaben <code>number</code> er 3 og dernæst optæl hvor mange <code>a</code> er tilbage i variablen <code>letter</code> (man kan afprøve på den første <code>tibble</code> hvis det hjælper).</li>
</ul>
<hr />
<p><strong>Problem 5</strong>) <em>group_by/nest øvelse</em></p>
<p><strong>a</strong>) For datasættet <code>iris</code>, anvend <code>group_by(Species)</code> og tilføj dernæst <code>nest()</code>, og kigger på resultatet.</p>
<p><strong>b</strong>)</p>
<ul>
<li>tilføj <code>pull(data)</code> og se på resultatet</li>
<li>fjern <code>pull(data)</code> og tilføj <code>pluck("data",1)</code> i stedet for, for at se den første dataramme.</li>
<li>tilføj <code>unnest(data)</code> i stedet for og se på resultatet</li>
<li>tilføj følgende i stedet for og prøve at forstå hvad der sker:
<ul>
<li><code>mutate(new_column_nrow = map_dbl(data,nrow))</code></li>
<li><code>mutate(new_column_ratio = map(data,~(.x$Sepal.Width/.x$Sepal.Length)))</code></li>
</ul></li>
</ul>
<p><strong>b</strong>) <em>Skift mellem long og wide form</em></p>
<ul>
<li>Afprøv også følgende funktion med <code>map()</code>-funktionen på kolonnen <code>data</code> (angiv ny kolonnenavne <code>new_column_long</code> i <code>mutate()</code>).</li>
</ul>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="functional-programming-med-purrr-pakken.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add an id and put data into long form</span></span>
<span id="cb429-2"><a href="functional-programming-med-purrr-pakken.html#cb429-2" aria-hidden="true" tabindex="-1"></a>my_func_longer <span class="ot">&lt;-</span> <span class="er">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>id)</span></code></pre></div>
<ul>
<li>Skriv en funktion og anvend den på kolonnen <code>new_column_long</code>, der laver hvert datasæt i kolonnen om til wide-form igen (lav ny kolonne “new_column_wide”).</li>
</ul>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="functional-programming-med-purrr-pakken.html#cb430-1" aria-hidden="true" tabindex="-1"></a>my_func_wider <span class="ot">&lt;-</span> ??? <span class="co">#lave long data om til wide form (husk at angiv names_from,values_from,id_cols)</span></span>
<span id="cb430-2"><a href="functional-programming-med-purrr-pakken.html#cb430-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb430-3"><a href="functional-programming-med-purrr-pakken.html#cb430-3" aria-hidden="true" tabindex="-1"></a>iris_nested_stats <span class="sc">%&gt;%</span> ???<span class="co">#anvend din funktion  </span></span></code></pre></div>
<ul>
<li>Anvend <code>pluck</code> på kolonnerne <code>new_column_long</code> og <code>new_column_wide</code> til at kigge på den første datasæt for at se, om du har outputtet i long/wide form som forventede.</li>
</ul>
<!-- * Brug `map` til at tilføje en ny kolonne `mean_ratio`, der viser middelværdierne af den ratio af `Sepal.Length` vs `Sepal.Width` (dvs. anvend `map` med kolonnen `new_column_ratio`). -->
<!-- ```{r,echo=F,eval=F} -->
<!-- my_func <- ~mean(.x,na.rm=T) -->
<!-- iris_nested_stats %>% mutate("mean_ratio" = map_dbl(new_column_ratio,my_func)) -->
<!-- ``` -->
<hr />
<p><strong>Problem 6</strong>) <em>group_by/nest + map</em> på datasættet <code>mtcars</code></p>
<p><strong>a)</strong> Åbn <code>mtcars</code> med <code>data(mtcars)</code> og anvende <code>group_by()</code>/<code>nest()</code> for at opdele datasættet i tre efter variablen <code>cyl</code>.</p>
<p><strong>b</strong>) Lave nye kolonner med <code>map</code> og inddrage hensigtsmæssige funktioner, som beskriver dine tre datasæt, der er lagret i kolonne <code>data</code> (outputtet skal være <code>dbl</code>):</p>
<ul>
<li>Antal observationer</li>
<li>Korrelationskoefficient mellem <code>wt</code> og <code>drat</code> (funktionen <code>cor</code>)</li>
<li>Antal unikke værdier fra variablen <code>gear</code></li>
</ul>
<p><strong>c</strong>) Omsætte dine statistikke til et plot for at sammenligne de tre datasæt.</p>
<hr />
<p><strong>Problem 7</strong>) <em>Forberedelse til næste lektion</em></p>
<p>For at bedre kunne se værdien af at bruge <code>group_by()</code>/<code>nest()</code> + <code>map()</code> kan vi gennemgå en simpel eksampel som indledning til vores næste lektion.</p>
<p>Tag funktionen:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="functional-programming-med-purrr-pakken.html#cb431-1" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="er">~</span> <span class="fu">t.test</span>(.x<span class="sc">$</span>Petal.Width,.x<span class="sc">$</span>Sepal.Length)</span></code></pre></div>
<ul>
<li>anvend <code>group_by(Species)</code> og dernæst <code>nest()</code> på datasættet <code>iris</code>.</li>
<li>tilføj <code>mutate()</code> til at lave en ny kolon som hedder <code>t_test</code> og bruge funktionen indenfor <code>map()</code> på kolonnen <code>data</code>.</li>
<li>tilføj <code>pull(t_test)</code> til din kommando - man får de tre t-tests frem, som man lige har beregnet.</li>
<li>prøv <code>unnest(t_test)</code> i stedet for <code>pull(t_test)</code> - man får en advarsel fordi de t-test resultater ikke er i en god form til at vise indenfor en dataramme. Vi vil gerne ændre deres output til tidy-form først.</li>
</ul>
<hr />
<ul>
<li>Nu installer R-pakken <code>broom</code> (<code>install.packages("broom")</code>)</li>
<li>Lav samme som ovenstående men bruge følgende funktion i stedet for (<code>glance()</code> få statistikkerne fra <code>t.test()</code> ind i en pæn form (<strong>tidy</strong>))</li>
</ul>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="functional-programming-med-purrr-pakken.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb432-2"><a href="functional-programming-med-purrr-pakken.html#cb432-2" aria-hidden="true" tabindex="-1"></a>my_func <span class="ot">&lt;-</span> <span class="er">~</span> <span class="fu">t.test</span>(.x<span class="sc">$</span>Petal.Width,.x<span class="sc">$</span>Sepal.Length) <span class="sc">%&gt;%</span> <span class="fu">glance</span>()</span></code></pre></div>
<ul>
<li><p>Tilføj <code>pull</code> eller <code>unnest</code> til din kommando som før og se på resultatet.</p></li>
<li><p>Man får en pæn dataramme frem med alle de forskellige statistikker fra <code>t.test()</code>.</p></li>
<li><p>Vælge en statistik og omsætte den til et plot.</p></li>
</ul>
<hr />
<p><strong>Problem 8</strong>) Hvis du færdig før tid kan du se videorne til næste emne i morgen :)</p>
<!-- __Problem 11__ -->
<!-- #nestby and map VS groupby and summarise -->
<!-- ```{r} -->
<!-- msleep_nested <- msleep %>% group_by(vore) %>% nest -->
<!-- msleep_nested <- msleep_nested %>% mutate("nrows" = map_int(data,nrow)) -->
<!-- msleep %>%  -->
<!--   group_by(vore) %>%  -->
<!--   summarise("max_sleep_rem" = max(sleep_rem,na.rm=T)) -->
<!-- #take a dataframe and calculate mean of the numeric columns -->
<!-- my_func <- ~.x %>% select(where(is.numeric)) %>% map(mean,na.rm=T) -->
<!-- msleep_nested <- msleep_nested %>%  -->
<!--   mutate("data_means" = map_df(data, my_func)) %>%  -->
<!--   unnest(data_means) -->
<!-- msleep_nested %>% select(-data) %>% pivot_longer(-vore) %>%  -->
<!--   ggplot(aes(x=vore,y=value,fill=vore)) +  -->
<!--   geom_bar(stat="identity",position="dodge") +  -->
<!--   facet_wrap(~name,scales="free") + -->
<!--   theme_bw() -->
<!-- ``` -->
</div>
<div id="ekstra-notater-og-næste-gang" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Ekstra notater og næste gang<a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://r4ds.had.co.nz/iteration.html" class="uri">https://r4ds.had.co.nz/iteration.html</a>
<a href="https://sanderwuyts.com/en/blog/purrr-tutorial/" class="uri">https://sanderwuyts.com/en/blog/purrr-tutorial/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bearbejdning-dag-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualisering-af-trends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["visualisering_22.pdf", "visualisering_22.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
