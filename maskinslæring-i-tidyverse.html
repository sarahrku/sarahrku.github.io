<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Maskinslæring i tidyverse | Analyse og visualisering af biologiske datasæt - 2022</title>
  <meta name="description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Maskinslæring i tidyverse | Analyse og visualisering af biologiske datasæt - 2022" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Maskinslæring i tidyverse | Analyse og visualisering af biologiske datasæt - 2022" />
  
  <meta name="twitter:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2022" />
  

<meta name="author" content="Sarah Rennie" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="emner-fra-eksperimental-design.html"/>
<link rel="next" href="presæntering-af-datasæt-over-for-andre.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualisering kursus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Grundlæggende R<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inledning-til-kapitel"><i class="fa fa-check"></i><b>1.1</b> Inledning til kapitel<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#de-forskellige-vinduer-i-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> De forskellige vinduer i RStudio<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-pakker"><i class="fa fa-check"></i><b>1.4</b> R pakker<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#hvor-kommer-vores-data-fra"><i class="fa fa-check"></i><b>1.5</b> Hvor kommer vores data fra?<span></span></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#indbyggede-datasæt"><i class="fa fa-check"></i><b>1.5.1</b> Indbyggede datasæt<span></span></a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#importering-af-data-fra-.txt-fil"><i class="fa fa-check"></i><b>1.5.2</b> Importering af data fra .txt fil<span></span></a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#importering-af-data-fra-excel"><i class="fa fa-check"></i><b>1.5.3</b> Importering af data fra Excel<span></span></a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#kaggle"><i class="fa fa-check"></i><b>1.5.4</b> Kaggle<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#beregninger-i-r"><i class="fa fa-check"></i><b>1.6</b> Beregninger i R<span></span></a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#vectorer"><i class="fa fa-check"></i><b>1.6.1</b> Vectorer<span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#datatyper"><i class="fa fa-check"></i><b>1.6.2</b> datatyper<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#dataframes"><i class="fa fa-check"></i><b>1.7</b> Dataframes<span></span></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#delmægder-af-dataframes"><i class="fa fa-check"></i><b>1.7.1</b> Delmægder af dataframes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Descriptive statistics<span></span></a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#simulere-data-fra-den-normale-fordeling"><i class="fa fa-check"></i><b>1.8.1</b> Simulere data fra den normale fordeling<span></span></a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.8.2</b> Measures of central tendency<span></span></a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#tapply"><i class="fa fa-check"></i><b>1.8.3</b> <code>tapply()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#statistike-tester"><i class="fa fa-check"></i><b>1.9</b> Statistike tester<span></span></a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#korrelation"><i class="fa fa-check"></i><b>1.9.1</b> Korrelation<span></span></a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#test-for-uafhængighed-chi-sq-test"><i class="fa fa-check"></i><b>1.9.2</b> Test for uafhængighed (chi-sq test)<span></span></a></li>
<li class="chapter" data-level="1.9.3" data-path="index.html"><a href="index.html#sample-t-test"><i class="fa fa-check"></i><b>1.9.3</b> 1 sample t-test<span></span></a></li>
<li class="chapter" data-level="1.9.4" data-path="index.html"><a href="index.html#sample-t-test-1"><i class="fa fa-check"></i><b>1.9.4</b> 2-sample t-test<span></span></a></li>
<li class="chapter" data-level="1.9.5" data-path="index.html"><a href="index.html#paired-t-test"><i class="fa fa-check"></i><b>1.9.5</b> Paired t-test<span></span></a></li>
<li class="chapter" data-level="1.9.6" data-path="index.html"><a href="index.html#anova-variansanalyse"><i class="fa fa-check"></i><b>1.9.6</b> ANOVA (variansanalyse)<span></span></a></li>
<li class="chapter" data-level="1.9.7" data-path="index.html"><a href="index.html#lineær-regression"><i class="fa fa-check"></i><b>1.9.7</b> Lineær regression<span></span></a></li>
<li class="chapter" data-level="1.9.8" data-path="index.html"><a href="index.html#r-squared-coefficient-of-determination"><i class="fa fa-check"></i><b>1.9.8</b> R-squared coefficient of determination<span></span></a></li>
<li class="chapter" data-level="1.9.9" data-path="index.html"><a href="index.html#antagelser---lineær-regression"><i class="fa fa-check"></i><b>1.9.9</b> Antagelser - lineær regression<span></span></a></li>
<li class="chapter" data-level="1.9.10" data-path="index.html"><a href="index.html#multiple-lineær-regression"><i class="fa fa-check"></i><b>1.9.10</b> Multiple lineær regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#problemstillinger"><i class="fa fa-check"></i><b>1.10</b> Problemstillinger<span></span></a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="index.html"><a href="index.html#quiz---basics"><i class="fa fa-check"></i><b>1.10.1</b> Quiz - Basics<span></span></a></li>
<li class="chapter" data-level="1.10.2" data-path="index.html"><a href="index.html#grundlæggende-r"><i class="fa fa-check"></i><b>1.10.2</b> Grundlæggende R<span></span></a></li>
<li class="chapter" data-level="1.10.3" data-path="index.html"><a href="index.html#kort-analyse-med-reaktionstider"><i class="fa fa-check"></i><b>1.10.3</b> Kort analyse med reaktionstider<span></span></a></li>
<li class="chapter" data-level="1.10.4" data-path="index.html"><a href="index.html#ekstra-øvelser-med-statistik-tests"><i class="fa fa-check"></i><b>1.10.4</b> Ekstra øvelser med statistik tests<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduktion til R Markdown<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#hvad-er-r-markdown"><i class="fa fa-check"></i><b>2.1</b> Hvad er R Markdown?<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#installere-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Installere R Markdown<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#videodemonstrationer"><i class="fa fa-check"></i><b>2.3</b> Videodemonstrationer<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#oprette-et-nyt-dokument-i-r-markdown"><i class="fa fa-check"></i><b>2.4</b> Oprette et nyt dokument i R Markdown<span></span></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml"><i class="fa fa-check"></i><b>2.4.1</b> YAML<span></span></a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#globale-options"><i class="fa fa-check"></i><b>2.4.2</b> Globale options<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#skrive-baseret-tekst"><i class="fa fa-check"></i><b>2.5</b> Skrive baseret tekst<span></span></a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.5.1</b> Headers<span></span></a></li>
<li class="chapter" data-level="2.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#liste"><i class="fa fa-check"></i><b>2.5.2</b> liste<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#knitte-kode"><i class="fa fa-check"></i><b>2.6</b> Knitte kode<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#kode-chunks"><i class="fa fa-check"></i><b>2.7</b> Kode chunks<span></span></a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rmarkdown.html"><a href="rmarkdown.html#et-godt-råd-når-man-arbejder-med-chunks"><i class="fa fa-check"></i><b>2.7.1</b> Et godt råd når man arbejder med chunks<span></span></a></li>
<li class="chapter" data-level="2.7.2" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-indstillinger"><i class="fa fa-check"></i><b>2.7.2</b> Chunk indstillinger<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#r-beregninger-indenfor-teksten-i-dokument-inline-code"><i class="fa fa-check"></i><b>2.8</b> R beregninger indenfor teksten i dokument (‘inline code’)<span></span></a></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory-1"><i class="fa fa-check"></i><b>2.9</b> Working directory<span></span></a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#matematik"><i class="fa fa-check"></i><b>2.10</b> Matematik<span></span></a></li>
<li class="chapter" data-level="2.11" data-path="rmarkdown.html"><a href="rmarkdown.html#problemstillinger-1"><i class="fa fa-check"></i><b>2.11</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="2.12" data-path="rmarkdown.html"><a href="rmarkdown.html#færdig-for-i-dag-og-næste-gang"><i class="fa fa-check"></i><b>2.12</b> Færdig for i dag og næste gang<span></span></a></li>
<li class="chapter" data-level="2.13" data-path="rmarkdown.html"><a href="rmarkdown.html#ekstra-links"><i class="fa fa-check"></i><b>2.13</b> Ekstra links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>3</b> Visualisering - ggplot2 dag 1<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="visual1.html"><a href="visual1.html#inledning-og-videoer"><i class="fa fa-check"></i><b>3.1</b> Inledning og videoer<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="visual1.html"><a href="visual1.html#læringsmålene-for-dag-1"><i class="fa fa-check"></i><b>3.1.1</b> Læringsmålene for dag 1<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="visual1.html"><a href="visual1.html#hvad-er-ggplot2"><i class="fa fa-check"></i><b>3.1.2</b> Hvad er <strong>ggplot2</strong>?<span></span></a></li>
<li class="chapter" data-level="3.1.3" data-path="visual1.html"><a href="visual1.html#brugen-af-materialerne"><i class="fa fa-check"></i><b>3.1.3</b> Brugen af materialerne<span></span></a></li>
<li class="chapter" data-level="3.1.4" data-path="visual1.html"><a href="visual1.html#video-ressourcer"><i class="fa fa-check"></i><b>3.1.4</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visual1.html"><a href="visual1.html#transition-fra-base-r-til-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Transition fra base R til ggplot2<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="visual1.html"><a href="visual1.html#vores-første-ggplot"><i class="fa fa-check"></i><b>3.3</b> Vores første ggplot<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="visual1.html"><a href="visual1.html#lidt-om-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Lidt om ggplot2<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visual1.html"><a href="visual1.html#syntax"><i class="fa fa-check"></i><b>3.4.1</b> Syntax<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="visual1.html"><a href="visual1.html#hvad-betyder-egentlig-grammar-of-graphics"><i class="fa fa-check"></i><b>3.4.2</b> Hvad betyder egentlig grammar of graphics?<span></span></a></li>
<li class="chapter" data-level="3.4.3" data-path="visual1.html"><a href="visual1.html#globale-versus-lokale-æstetik"><i class="fa fa-check"></i><b>3.4.3</b> Globale versus lokale æstetik<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visual1.html"><a href="visual1.html#specificere-etiketter-og-titel"><i class="fa fa-check"></i><b>3.5</b> Specificere etiketter og titel<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="visual1.html"><a href="visual1.html#ændre-farver"><i class="fa fa-check"></i><b>3.6</b> Ændre farver<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="visual1.html"><a href="visual1.html#ændre-tema"><i class="fa fa-check"></i><b>3.7</b> Ændre tema<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="visual1.html"><a href="visual1.html#forskellige-geoms"><i class="fa fa-check"></i><b>3.8</b> Forskellige geoms<span></span></a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visual1.html"><a href="visual1.html#boxplot-geom_box"><i class="fa fa-check"></i><b>3.8.1</b> Boxplot (<code>geom_box</code>)<span></span></a></li>
<li class="chapter" data-level="3.8.2" data-path="visual1.html"><a href="visual1.html#barplot-geom_bar"><i class="fa fa-check"></i><b>3.8.2</b> Barplot (<code>geom_bar</code>)<span></span></a></li>
<li class="chapter" data-level="3.8.3" data-path="visual1.html"><a href="visual1.html#histogram-geom_histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram (<code>geom_histogram</code>)<span></span></a></li>
<li class="chapter" data-level="3.8.4" data-path="visual1.html"><a href="visual1.html#density-geom_density"><i class="fa fa-check"></i><b>3.8.4</b> Density (<code>geom_density</code>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visual1.html"><a href="visual1.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting<span></span></a></li>
<li class="chapter" data-level="3.10" data-path="visual1.html"><a href="visual1.html#problemstillinger-2"><i class="fa fa-check"></i><b>3.10</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="3.11" data-path="visual1.html"><a href="visual1.html#næste-gang"><i class="fa fa-check"></i><b>3.11</b> Næste gang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual2.html"><a href="visual2.html"><i class="fa fa-check"></i><b>4</b> Visualisering - ggplot2 dag 2<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="visual2.html"><a href="visual2.html#indledning-og-videoer"><i class="fa fa-check"></i><b>4.1</b> Indledning og videoer<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visual2.html"><a href="visual2.html#læringsmålene"><i class="fa fa-check"></i><b>4.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="visual2.html"><a href="visual2.html#video-ressourcer-1"><i class="fa fa-check"></i><b>4.1.2</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visual2.html"><a href="visual2.html#koordinat-systemer"><i class="fa fa-check"></i><b>4.2</b> Koordinat systemer<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visual2.html"><a href="visual2.html#zoom-coord_cartesian-expand_limits"><i class="fa fa-check"></i><b>4.2.1</b> Zoom (<code>coord_cartesian()</code>, <code>expand_limits()</code>)<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="visual2.html"><a href="visual2.html#transformering-af-akserne---log-sqrt-osv-scale_x_continuous."><i class="fa fa-check"></i><b>4.2.2</b> Transformering af akserne - log, sqrt osv (<code>scale_x_continuous</code>).<span></span></a></li>
<li class="chapter" data-level="4.2.3" data-path="visual2.html"><a href="visual2.html#flip-coordinates-coord_flip"><i class="fa fa-check"></i><b>4.2.3</b> Flip coordinates (<code>coord_flip</code>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visual2.html"><a href="visual2.html#mere-om-farver-og-punkt-former"><i class="fa fa-check"></i><b>4.3</b> Mere om farver og punkt former<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visual2.html"><a href="visual2.html#automatisk-farver"><i class="fa fa-check"></i><b>4.3.1</b> Automatisk farver<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="visual2.html"><a href="visual2.html#manuelle-farver"><i class="fa fa-check"></i><b>4.3.2</b> Manuelle farver<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="visual2.html"><a href="visual2.html#punkt-former"><i class="fa fa-check"></i><b>4.3.3</b> Punkt former<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visual2.html"><a href="visual2.html#annotations-geom_text"><i class="fa fa-check"></i><b>4.4</b> Annotations (<code>geom_text</code>)<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visual2.html"><a href="visual2.html#tilføje-labeller-direkte-på-plottet."><i class="fa fa-check"></i><b>4.4.1</b> Tilføje labeller direkte på plottet.<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="visual2.html"><a href="visual2.html#pakken-ggrepel-for-at-tilføje-tekst-labeller"><i class="fa fa-check"></i><b>4.4.2</b> Pakken <code>ggrepel</code> for at tilføje tekst labeller<span></span></a></li>
<li class="chapter" data-level="4.4.3" data-path="visual2.html"><a href="visual2.html#tilføje-rektangler-i-regioner-af-interesse-annotate"><i class="fa fa-check"></i><b>4.4.3</b> Tilføje rektangler i regioner af interesse (<code>annotate</code>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visual2.html"><a href="visual2.html#adskille-plots-med-facets-facet_gridfacet_wrap"><i class="fa fa-check"></i><b>4.5</b> Adskille plots med facets (<code>facet_grid</code>/<code>facet_wrap</code>)<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="visual2.html"><a href="visual2.html#gemme-dit-plot"><i class="fa fa-check"></i><b>4.6</b> Gemme dit plot<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="visual2.html"><a href="visual2.html#problemstillinger-3"><i class="fa fa-check"></i><b>4.7</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="visual2.html"><a href="visual2.html#ekstra-links-1"><i class="fa fa-check"></i><b>4.8</b> Ekstra links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Bearbejdning dag 1<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#hvad-er-tidyverse"><i class="fa fa-check"></i><b>5.1</b> Hvad er Tidyverse?<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#video-ressourcer-2"><i class="fa fa-check"></i><b>5.2</b> Video ressourcer<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#oversigt-over-pakker"><i class="fa fa-check"></i><b>5.3</b> Oversigt over pakker<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#principper-med-tidy-data"><i class="fa fa-check"></i><b>5.4</b> Principper med ‘tidy data’<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#lidt-om-tibbles"><i class="fa fa-check"></i><b>5.5</b> Lidt om <code>tibbles</code><span></span></a></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#transition-fra-base-til-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Transition fra base til tidyverse<span></span></a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#om-titanic-datasæt"><i class="fa fa-check"></i><b>5.6.1</b> Om <strong>Titanic</strong> datasæt<span></span></a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#titanic-oprydning"><i class="fa fa-check"></i><b>5.6.2</b> Titanic: oprydning<span></span></a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#pipe"><i class="fa fa-check"></i><b>5.6.3</b> Pipe<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#bearbejdning-af-data-dplyr"><i class="fa fa-check"></i><b>5.7</b> Bearbejdning af data: <code>dplyr</code><span></span></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#dplyr-verbs-select"><i class="fa fa-check"></i><b>5.7.1</b> dplyr verbs: <code>select()</code><span></span></a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#dplyr-verbs-filter"><i class="fa fa-check"></i><b>5.7.2</b> dplyr verbs: <code>filter()</code><span></span></a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#comparitiver-reference"><i class="fa fa-check"></i><b>5.7.3</b> Comparitiver reference<span></span></a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#kombinere-filter-og-select"><i class="fa fa-check"></i><b>5.7.4</b> Kombinere <code>filter()</code> og <code>select()</code><span></span></a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#dplyr-verbs-mutate"><i class="fa fa-check"></i><b>5.7.5</b> dplyr verbs: <code>mutate()</code><span></span></a></li>
<li class="chapter" data-level="5.7.6" data-path="data.html"><a href="data.html#rename"><i class="fa fa-check"></i><b>5.7.6</b> <code>rename()</code><span></span></a></li>
<li class="chapter" data-level="5.7.7" data-path="data.html"><a href="data.html#dplyr-verbs-recode"><i class="fa fa-check"></i><b>5.7.7</b> dplyr verbs: <code>recode()</code><span></span></a></li>
<li class="chapter" data-level="5.7.8" data-path="data.html"><a href="data.html#dplyr-verbs-arrange"><i class="fa fa-check"></i><b>5.7.8</b> dplyr verbs: <code>arrange()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#visualisering-bruge-som-input-i-ggplot2"><i class="fa fa-check"></i><b>5.8</b> Visualisering: bruge som input i ggplot2<span></span></a></li>
<li class="chapter" data-level="5.9" data-path="data.html"><a href="data.html#misc-funktioner-som-er-nyttige-at-vide"><i class="fa fa-check"></i><b>5.9</b> Misc funktioner som er nyttige at vide<span></span></a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data.html"><a href="data.html#pull"><i class="fa fa-check"></i><b>5.9.1</b> Pull<span></span></a></li>
<li class="chapter" data-level="5.9.2" data-path="data.html"><a href="data.html#slice"><i class="fa fa-check"></i><b>5.9.2</b> Slice<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data.html"><a href="data.html#problemstillinger-4"><i class="fa fa-check"></i><b>5.10</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="5.11" data-path="data.html"><a href="data.html#kommentarer"><i class="fa fa-check"></i><b>5.11</b> Kommentarer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html"><i class="fa fa-check"></i><b>6</b> Bearbejdning dag 2<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#indledning-og-læringsmålene"><i class="fa fa-check"></i><b>6.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#læringsmålene-1"><i class="fa fa-check"></i><b>6.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#videoer"><i class="fa fa-check"></i><b>6.1.2</b> Videoer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#group_by-med-summarise-i-dplyr-pakken"><i class="fa fa-check"></i><b>6.2</b> <code>group_by()</code> med <code>summarise()</code> i dplyr-pakken<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#reference-af-summarise-funktioner"><i class="fa fa-check"></i><b>6.2.1</b> Reference af <code>summarise()</code> funktioner<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#flere-summary-statistic-på-én-gang"><i class="fa fa-check"></i><b>6.2.2</b> Flere summary statistic på én gang<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#mere-kompliceret-group_by"><i class="fa fa-check"></i><b>6.2.3</b> Mere kompliceret <code>group_by()</code><span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-ungroup"><i class="fa fa-check"></i><b>6.2.4</b> Funktionen <code>ungroup</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#pivot_longerpivot_wider-med-tidyr-pakken"><i class="fa fa-check"></i><b>6.3</b> <code>pivot_longer()</code>/<code>pivot_wider()</code> med Tidyr-pakken<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#tidyr-pakke---oversigt"><i class="fa fa-check"></i><b>6.3.1</b> Tidyr pakke - oversigt<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#wide---long-med-pivot_longer"><i class="fa fa-check"></i><b>6.3.2</b> Wide -&gt; Long med <code>pivot_longer()</code><span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#separate"><i class="fa fa-check"></i><b>6.3.3</b> <code>separate()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#eksempel-titanic-summary-statistics"><i class="fa fa-check"></i><b>6.4</b> Eksempel: Titanic summary statistics<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#demonstration-af-pivot_wider"><i class="fa fa-check"></i><b>6.4.1</b> Demonstration af <code>pivot_wider()</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#left_join-forbinde-dataframes"><i class="fa fa-check"></i><b>6.5</b> <code>left_join()</code>: forbinde dataframes<span></span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#funktionen-left_join-fra-dplyr-pakken"><i class="fa fa-check"></i><b>6.5.1</b> Funktionen <code>left_join()</code> fra dplyr-pakken<span></span></a></li>
<li class="chapter" data-level="6.5.2" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#anvende-left_join-for-vores-dataset."><i class="fa fa-check"></i><b>6.5.2</b> Anvende <code>left_join()</code> for vores dataset.<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#problemstillinger-5"><i class="fa fa-check"></i><b>6.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="6.7" data-path="bearbejdning-dag-2.html"><a href="bearbejdning-dag-2.html#ekstra-links-2"><i class="fa fa-check"></i><b>6.7</b> Ekstra links<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html"><i class="fa fa-check"></i><b>7</b> Functional programming med purrr-pakken<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene"><i class="fa fa-check"></i><b>7.1</b> Inledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#læringsmålene-2"><i class="fa fa-check"></i><b>7.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#video-ressourcer-3"><i class="fa fa-check"></i><b>7.1.2</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#iterativ-processer-med-map-fuktioner"><i class="fa fa-check"></i><b>7.2</b> Iterativ processer med <code>map()</code> fuktioner<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner"><i class="fa fa-check"></i><b>7.2.1</b> Introduktion til <code>map()</code> funktioner<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#reference-for-the-different-map-functions"><i class="fa fa-check"></i><b>7.2.2</b> Reference for the different map functions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#custom-fuktioner"><i class="fa fa-check"></i><b>7.3</b> Custom fuktioner<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#simple-functions"><i class="fa fa-check"></i><b>7.3.1</b> Simple functions<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#custom-functions-with-mapping"><i class="fa fa-check"></i><b>7.3.2</b> Custom functions with mapping<span></span></a></li>
<li class="chapter" data-level="7.3.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-data-typer"><i class="fa fa-check"></i><b>7.3.3</b> Effekten af <code>map</code> på andre data typer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#nesting-nest"><i class="fa fa-check"></i><b>7.4</b> Nesting <code>nest()</code><span></span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#anvende-map-med-nested-data"><i class="fa fa-check"></i><b>7.4.1</b> Anvende map() med nested data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr"><i class="fa fa-check"></i><b>7.5</b> Andre brugbar purrr<span></span></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#map2-function-for-flere-inputs"><i class="fa fa-check"></i><b>7.5.1</b> <code>map2()</code> function for flere inputs<span></span></a></li>
<li class="chapter" data-level="7.5.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#transformer-numeriske-variabler"><i class="fa fa-check"></i><b>7.5.2</b> Transformer numeriske variabler<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#problemstillinger-6"><i class="fa fa-check"></i><b>7.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="7.7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang"><i class="fa fa-check"></i><b>7.7</b> Ekstra notater og næste gang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html"><i class="fa fa-check"></i><b>8</b> Visualisering af trends<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#indledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>8.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#læringsmålene-3"><i class="fa fa-check"></i><b>8.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#introduktion-til-chapter"><i class="fa fa-check"></i><b>8.1.2</b> Introduktion til chapter<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#video-ressourcer-4"><i class="fa fa-check"></i><b>8.1.3</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#nest-og-map-eksempel-med-korrelation"><i class="fa fa-check"></i><b>8.2</b> <code>nest()</code> og <code>map()</code>: eksempel med korrelation<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#korrelation-over-flere-datasæt-på-en-gang"><i class="fa fa-check"></i><b>8.2.1</b> Korrelation over flere datasæt på en gang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineær-regression---visualisering"><i class="fa fa-check"></i><b>8.3</b> Lineær regression - visualisering<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#lineær-trends"><i class="fa fa-check"></i><b>8.3.1</b> Lineær trends<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-lm-trendlinjer"><i class="fa fa-check"></i><b>8.3.2</b> <code>geom_smooth()</code>: <code>lm</code> trendlinjer<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#geom_smooth-flere-lm-trendlinjer-på-samme-plot"><i class="fa fa-check"></i><b>8.3.3</b> <code>geom_smooth()</code>: flere <code>lm</code> trendlinjer på samme plot<span></span></a></li>
<li class="chapter" data-level="8.3.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#trendlinjer-med-methodloess"><i class="fa fa-check"></i><b>8.3.4</b> Trendlinjer med <code>method=="loess"</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#plot-linear-regresion-estimates"><i class="fa fa-check"></i><b>8.4</b> Plot linear regresion estimates<span></span></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anvende-lm-over-nested-datasæt"><i class="fa fa-check"></i><b>8.4.1</b> Anvende <code>lm()</code> over nested datasæt<span></span></a></li>
<li class="chapter" data-level="8.4.2" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#funktion-glue-for-at-tilføje-labels"><i class="fa fa-check"></i><b>8.4.2</b> Funktion <code>glue()</code> for at tilføje labels<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#multiple-regression-and-model-comparison"><i class="fa fa-check"></i><b>8.5</b> Multiple regression and model comparison<span></span></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#anova-for-at-sammenligne-de-forskellige-modeller"><i class="fa fa-check"></i><b>8.5.1</b> <code>anova</code> for at sammenligne de forskellige modeller<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#problemstillinger-7"><i class="fa fa-check"></i><b>8.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="8.7" data-path="visualisering-af-trends.html"><a href="visualisering-af-trends.html#ekstra"><i class="fa fa-check"></i><b>8.7</b> Ekstra<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#indledning-og-læringsmålene-2"><i class="fa fa-check"></i><b>9.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="clustering.html"><a href="clustering.html#læringsmålene-4"><i class="fa fa-check"></i><b>9.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="clustering.html"><a href="clustering.html#inledning-til-chapter"><i class="fa fa-check"></i><b>9.1.2</b> Inledning til chapter<span></span></a></li>
<li class="chapter" data-level="9.1.3" data-path="clustering.html"><a href="clustering.html#video-ressourcer-5"><i class="fa fa-check"></i><b>9.1.3</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#method-1-k-means-clustering"><i class="fa fa-check"></i><b>9.2</b> Method 1: K-means clustering<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="clustering.html"><a href="clustering.html#hvordan-fungere-kmeans"><i class="fa fa-check"></i><b>9.2.1</b> Hvordan fungere kmeans?<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="clustering.html"><a href="clustering.html#withinbetween-sum-of-squares"><i class="fa fa-check"></i><b>9.2.2</b> Within/between sum of squares<span></span></a></li>
<li class="chapter" data-level="9.2.3" data-path="clustering.html"><a href="clustering.html#run-k-means-i-r"><i class="fa fa-check"></i><b>9.2.3</b> Run k-means i R<span></span></a></li>
<li class="chapter" data-level="9.2.4" data-path="clustering.html"><a href="clustering.html#tidy-up-k-means-resultaterne-med-pakken-broom"><i class="fa fa-check"></i><b>9.2.4</b> Tidy up k-means resultaterne med pakken <code>broom</code><span></span></a></li>
<li class="chapter" data-level="9.2.5" data-path="clustering.html"><a href="clustering.html#plotcentroids"><i class="fa fa-check"></i><b>9.2.5</b> Plot cluster centroids<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#kmeans-hvor-mange-clusters"><i class="fa fa-check"></i><b>9.3</b> Kmeans: hvor mange clusters?<span></span></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="clustering.html"><a href="clustering.html#få-broom-output-for-forskellige-antal-clusters"><i class="fa fa-check"></i><b>9.3.1</b> Få Broom output for forskellige antal clusters<span></span></a></li>
<li class="chapter" data-level="9.3.2" data-path="clustering.html"><a href="clustering.html#elbow-plot-glance"><i class="fa fa-check"></i><b>9.3.2</b> Elbow plot (glance)<span></span></a></li>
<li class="chapter" data-level="9.3.3" data-path="clustering.html"><a href="clustering.html#automatistke-beslutning-med-pakken-nbclust"><i class="fa fa-check"></i><b>9.3.3</b> Automatistke beslutning med pakken <code>NbClust</code><span></span></a></li>
<li class="chapter" data-level="9.3.4" data-path="clustering.html"><a href="clustering.html#plot-de-forskellige-antal-clusters-augment"><i class="fa fa-check"></i><b>9.3.4</b> Plot de forskellige antal clusters (augment)<span></span></a></li>
<li class="chapter" data-level="9.3.5" data-path="clustering.html"><a href="clustering.html#nestmap-ramme-fra-sidste-gange"><i class="fa fa-check"></i><b>9.3.5</b> Nest/map ramme fra sidste gange<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#method-2-hierarchical-clustering"><i class="fa fa-check"></i><b>9.4</b> Method 2: Hierarchical clustering<span></span></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="clustering.html"><a href="clustering.html#vælge-ønkset-antal-clusters"><i class="fa fa-check"></i><b>9.4.1</b> Vælge ønkset antal clusters<span></span></a></li>
<li class="chapter" data-level="9.4.2" data-path="clustering.html"><a href="clustering.html#lav-et-pænt-plot-af-dendrogram-med-ggplot2"><i class="fa fa-check"></i><b>9.4.2</b> Lav et pænt plot af dendrogram med ggplot2<span></span></a></li>
<li class="chapter" data-level="9.4.3" data-path="clustering.html"><a href="clustering.html#ekstra-valgfri-afprøve-andre-metoder-på-hierachical-clustering"><i class="fa fa-check"></i><b>9.4.3</b> Ekstra (valgfri): afprøve andre metoder på hierachical clustering<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#problemstillinger-8"><i class="fa fa-check"></i><b>9.5</b> Problemstillinger<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i><b>10</b> Principal component analysis (PCA)<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#indledning-og-læringsmålene-3"><i class="fa fa-check"></i><b>10.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#læringsmålene-5"><i class="fa fa-check"></i><b>10.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="10.1.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#introduktion-til-chapter-1"><i class="fa fa-check"></i><b>10.1.2</b> Introduktion til chapter<span></span></a></li>
<li class="chapter" data-level="10.1.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#video-ressourcer-6"><i class="fa fa-check"></i><b>10.1.3</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#hvad-er-principal-component-analysis-pca"><i class="fa fa-check"></i><b>10.2</b> Hvad er principal component analysis (PCA)?<span></span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#simpel-eksempel-med-to-dimensioner"><i class="fa fa-check"></i><b>10.2.1</b> Simpel eksempel med to dimensioner<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#fit-pca-to-data-in-r"><i class="fa fa-check"></i><b>10.3</b> Fit PCA to data in R<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#integrere-pca-resultater-med-broom-pakke"><i class="fa fa-check"></i><b>10.4</b> Integrere PCA resultater med broom-pakke<span></span></a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#rotation-matrix-for-at-udtrækker-bidragen-af-de-forskellige-variabler"><i class="fa fa-check"></i><b>10.4.1</b> Rotation matrix for at udtrækker bidragen af de forskellige variabler<span></span></a></li>
<li class="chapter" data-level="10.4.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#pakken-factoextra"><i class="fa fa-check"></i><b>10.4.2</b> Pakken <code>factoextra</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#problemstillinger-9"><i class="fa fa-check"></i><b>10.5</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="10.6" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#ekstra-læsning"><i class="fa fa-check"></i><b>10.6</b> Ekstra læsning<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html"><i class="fa fa-check"></i><b>11</b> Emner fra eksperimental design<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#inledning-og-læringsmålene-1"><i class="fa fa-check"></i><b>11.1</b> Inledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#læringsmålene-6"><i class="fa fa-check"></i><b>11.1.1</b> Læringsmålene<span></span></a></li>
<li class="chapter" data-level="11.1.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#inledning-til-chapter-1"><i class="fa fa-check"></i><b>11.1.2</b> Inledning til chapter<span></span></a></li>
<li class="chapter" data-level="11.1.3" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#video-ressourcer-7"><i class="fa fa-check"></i><b>11.1.3</b> Video ressourcer<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#grundlæggende-principper-i-eksperimental-design"><i class="fa fa-check"></i><b>11.2</b> Grundlæggende principper i eksperimental design<span></span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#randomisation-and-replication"><i class="fa fa-check"></i><b>11.2.1</b> Randomisation and replication<span></span></a></li>
<li class="chapter" data-level="11.2.2" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#eksempel-med-datasættet-toothgrowth"><i class="fa fa-check"></i><b>11.2.2</b> Eksempel med datasættet <code>ToothGrowth</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#case-studies-simpsons-paradox"><i class="fa fa-check"></i><b>11.3</b> Case studies: Simpson’s paradox<span></span></a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#berkerly-admissions"><i class="fa fa-check"></i><b>11.3.1</b> Berkerly admissions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#case-studies-anscombes-quartet"><i class="fa fa-check"></i><b>11.4</b> Case studies: Anscombe’s quartet<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#undersøgelse-af-batch-effects"><i class="fa fa-check"></i><b>11.5</b> Undersøgelse af “batch-effects”<span></span></a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#principal-component-tilgang"><i class="fa fa-check"></i><b>11.5.1</b> Principal component tilgang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#problemstillinger-10"><i class="fa fa-check"></i><b>11.6</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="11.7" data-path="emner-fra-eksperimental-design.html"><a href="emner-fra-eksperimental-design.html#yderligere-læsning"><i class="fa fa-check"></i><b>11.7</b> Yderligere læsning<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html"><i class="fa fa-check"></i><b>12</b> Maskinslæring i tidyverse<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#indledning-og-læringsmålene-4"><i class="fa fa-check"></i><b>12.1</b> Indledning og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#læringsmålene-7"><i class="fa fa-check"></i><b>12.1.1</b> Læringsmålene<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#video-ressourcer-8"><i class="fa fa-check"></i><b>12.2</b> Video ressourcer<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#regression-models"><i class="fa fa-check"></i><b>12.3</b> Regression models<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#oprette-testing-and-training-sets"><i class="fa fa-check"></i><b>12.3.1</b> Oprette testing and training sets<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#cross-fold-validation"><i class="fa fa-check"></i><b>12.3.2</b> Cross-fold validation<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#bygge-modellen-og-lave-forudsigelser"><i class="fa fa-check"></i><b>12.3.3</b> Bygge modellen og lave forudsigelser<span></span></a></li>
<li class="chapter" data-level="12.3.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#vurdere-resultater-på-validation-sæt"><i class="fa fa-check"></i><b>12.3.4</b> Vurdere resultater på validation sæt<span></span></a></li>
<li class="chapter" data-level="12.3.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#teste-og-evaluere-final-model"><i class="fa fa-check"></i><b>12.3.5</b> Teste og evaluere “final” model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#classification-models"><i class="fa fa-check"></i><b>12.4</b> Classification models<span></span></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#splitte-datasættet-og-lave-cross-validation-dataframe"><i class="fa fa-check"></i><b>12.4.1</b> Splitte datasættet og lave cross-validation dataframe<span></span></a></li>
<li class="chapter" data-level="12.4.2" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#definere-classification-model"><i class="fa fa-check"></i><b>12.4.2</b> Definere classification model<span></span></a></li>
<li class="chapter" data-level="12.4.3" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#anvende-modellen-og-lave-predictions"><i class="fa fa-check"></i><b>12.4.3</b> Anvende modellen og lave predictions<span></span></a></li>
<li class="chapter" data-level="12.4.4" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#beregne-accuracy"><i class="fa fa-check"></i><b>12.4.4</b> Beregne accuracy<span></span></a></li>
<li class="chapter" data-level="12.4.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#parameter-tuning"><i class="fa fa-check"></i><b>12.4.5</b> Parameter tuning<span></span></a></li>
<li class="chapter" data-level="12.4.6" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#lave-final-model-med-titanic-datasæt"><i class="fa fa-check"></i><b>12.4.6</b> Lave final model med titanic datasæt<span></span></a></li>
<li class="chapter" data-level="12.4.7" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#variable-importance"><i class="fa fa-check"></i><b>12.4.7</b> Variable importance<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#problemstillinger-11"><i class="fa fa-check"></i><b>12.5</b> Problemstillinger<span></span></a></li>
<li class="chapter" data-level="12.6" data-path="maskinslæring-i-tidyverse.html"><a href="maskinslæring-i-tidyverse.html#yderligere-kommentarer-og-pakker"><i class="fa fa-check"></i><b>12.6</b> Yderligere kommentarer og pakker<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html"><i class="fa fa-check"></i><b>13</b> Presæntering af datasæt over for andre<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#introduktion-til-chapter-og-læringsmålene"><i class="fa fa-check"></i><b>13.1</b> Introduktion til chapter og læringsmålene<span></span></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#læringsmålene-8"><i class="fa fa-check"></i><b>13.1.1</b> Læringsmålene<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#video-ressourcer-9"><i class="fa fa-check"></i><b>13.2</b> Video ressourcer<span></span></a></li>
<li class="chapter" data-level="13.3" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#interactiv-plots"><i class="fa fa-check"></i><b>13.3</b> Interactiv plots<span></span></a></li>
<li class="chapter" data-level="13.4" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#shiny"><i class="fa fa-check"></i><b>13.4</b> Shiny<span></span></a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#eksempeler-som-viser-shiny"><i class="fa fa-check"></i><b>13.4.1</b> Eksempeler som viser Shiny<span></span></a></li>
<li class="chapter" data-level="13.4.2" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#create-new-app"><i class="fa fa-check"></i><b>13.4.2</b> Create new app<span></span></a></li>
<li class="chapter" data-level="13.4.3" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#struktur-af-en-shiny-app"><i class="fa fa-check"></i><b>13.4.3</b> Struktur af en Shiny App<span></span></a></li>
<li class="chapter" data-level="13.4.4" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#minimal-example-men-ikke-interaktiv"><i class="fa fa-check"></i><b>13.4.4</b> Minimal example (men ikke interaktiv)<span></span></a></li>
<li class="chapter" data-level="13.4.5" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#minimal-example---interactiv."><i class="fa fa-check"></i><b>13.4.5</b> Minimal example - interactiv.<span></span></a></li>
<li class="chapter" data-level="13.4.6" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#flere-plots-på-samme-shiny-app"><i class="fa fa-check"></i><b>13.4.6</b> Flere plots på samme Shiny app<span></span></a></li>
<li class="chapter" data-level="13.4.7" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#involvere-en-table"><i class="fa fa-check"></i><b>13.4.7</b> Involvere en table<span></span></a></li>
<li class="chapter" data-level="13.4.8" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#add-a-slider"><i class="fa fa-check"></i><b>13.4.8</b> Add a slider<span></span></a></li>
<li class="chapter" data-level="13.4.9" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#ekstras-som-man-kan-tilføje-til-ui"><i class="fa fa-check"></i><b>13.4.9</b> Ekstras som man kan tilføje til <code>ui</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#ekstra-generelle-råd"><i class="fa fa-check"></i><b>13.5</b> Ekstra generelle råd<span></span></a></li>
<li class="chapter" data-level="13.6" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#andre-mulighederadvanceret-topics"><i class="fa fa-check"></i><b>13.6</b> Andre muligheder/advanceret topics<span></span></a></li>
<li class="chapter" data-level="13.7" data-path="presæntering-af-datasæt-over-for-andre.html"><a href="presæntering-af-datasæt-over-for-andre.html#problemstillinger-12"><i class="fa fa-check"></i><b>13.7</b> Problemstillinger<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse og visualisering af biologiske datasæt - 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="maskinslæring-i-tidyverse" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Maskinslæring i tidyverse<a href="maskinslæring-i-tidyverse.html#maskinslæring-i-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="plots/hex-tidyverse.png" width="15%" /><img src="plots/ggplot2_logo.jpeg" width="15%" /><img src="plots/purrr.png" width="15%" /><img src="plots/pipe_logo.png" width="15%" /><img src="plots/rsample_logo.png" width="15%" /><img src="plots/tidymodels_logo.png" width="15%" /></p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="maskinslæring-i-tidyverse.html#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample) <span class="co">#install this</span></span>
<span id="cb618-2"><a href="maskinslæring-i-tidyverse.html#cb618-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb618-3"><a href="maskinslæring-i-tidyverse.html#cb618-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger) <span class="co">#install this, random forest</span></span>
<span id="cb618-4"><a href="maskinslæring-i-tidyverse.html#cb618-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span></code></pre></div>
<p>“Absorber hvad der er nyttigt, afvis det, der er ubrugeligt, tilføj det, der specifikt er dit eget.” - Bruce Lee</p>
<div id="indledning-og-læringsmålene-4" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Indledning og læringsmålene<a href="maskinslæring-i-tidyverse.html#indledning-og-læringsmålene-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Her bliver en lynhurtig introduktion til maskinslæring koncepter - emnet er i virkelighed kæmpe stort og jeg springer over mange detaljer her. Men jeg håber, at det giver en god grundlag/forståelse af den overordnet ramme, og at det kan være med til at øge forståelsen af de mange artikler i biologiske område der benytter maskinslæring modeller, samt motivere dig til at eventuelle tage yderligere kurser i området.</p>
<p>I emnet i dag introducerer jeg den grundlæggende ramme hvor man udvikler en model på træning data med cross-fold-validation og dernæst vurderer den model på testing data, som ikke var en del af selve træningsprocessen. Jeg inddrager også en classification model, som vi både optimerer (“tune”) og bruger til at forudsige hvem, der overlevede tradgedien på titanic!</p>
<p>Jeg har bestræbt på at arbejde så vidt som muligt kun indenfor for den tidyverse ramme og sæt funktioner vi allerede har dækket i kurset, som gør det nemmere at forstå mæskingslæring processen uden at blive distraheret af mange nye pakker og funktioner. Processen virker måske lidt indviklet i starten, men generaliseres meget og nemt kan udvides i mange kontekster og situationer - du kan nærmest tage eget data og bare tilpasse min kode fra enten den regression eller classification scenarie nedenunder.</p>
<!-- En anvendelse af modellen kan være, at hvis der kommer nye observationer, så hvor godt kan vi bruge modellen til at beregne deres vægt? Det kan fortæller også om hvordan målingerne relatere til vægten, samt brugbar i situationer hvor man ikke kender pingviners vægt - mange lignende situationer opstå mange gange i biologi og medicin: -->
<!-- * Man har målinger om en patient og gerne vil beregne risiko for, at patienten udvikler en bestemt sygdomme ud fra målingerne -->
<!-- * Man har et billede fk. fra en biopsi og man gerne vil anvende mæskinlærings for at classificere status på patienten. -->
<div id="læringsmålene-7" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Læringsmålene<a href="maskinslæring-i-tidyverse.html#læringsmålene-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Du skal være i stand til at</p>
<ul>
<li>Kende anvendelse af testing og training datasæt og beskrive cross-fold-validation processen</li>
<li>Anvende 5-fold-cross validation til at udvikle en model og beregner statistikker til at evaluere modellen</li>
<li>Lave en classification model for at forudsige hvem der overlevede titanic</li>
<li>Lave “tuning” af en parameter og bestemme om en “final” model</li>
</ul>
</div>
</div>
<div id="video-ressourcer-8" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Video ressourcer<a href="maskinslæring-i-tidyverse.html#video-ressourcer-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Video 1: Data splitting and cross-fold validation i en regression kontekst</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/714090516" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 2: Cross-fold validation i en classifcation contekst (random forest)</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/714090621" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 3: Tuning af parametre i classification og variabel importance</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/714090572" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="regression-models" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Regression models<a href="maskinslæring-i-tidyverse.html#regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi starter med at bygge processen op i en kontekst som vi godt kender i forvejen - en lineær regression model. Til det formål benytter vi endnu engang datasættet <code>penguins</code>, og målet er: hvor godt kan man forudsige variablen <code>body_mass_g</code> i de forskellige pingviner?</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="maskinslæring-i-tidyverse.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb619-2"><a href="maskinslæring-i-tidyverse.html#cb619-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<div id="oprette-testing-and-training-sets" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Oprette testing and training sets<a href="maskinslæring-i-tidyverse.html#oprette-testing-and-training-sets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hvordan kan man vide, om en model er god til at forudsige hvad der sker når der kommer nye observationer? Det vil sige, fungerer modellen godt kun i forhold til observationerne som blev brugt til at opbygge selve modellen (så kaldt “overfitting”), eller kan modellen generalises til andre, ligenende situationer? For at vide det kan man overvejer at splitte datasættet før man lave modellen - det vil sige et datasæt som man bruger til at opbygge modellen, og et datasæt som man kan bruge som “nye observationer”, hvor man kan teste, hvor godt modellen egentlig er (fordi i datasættet kender vi faktisk de virkelige værdier som vi kan sammenligne med vores forudsigelser fra modellen).</p>
<p><img src="plots/machine_step1.png" width="90%" /></p>
<p>Pakken <code>rsample</code> fra <code>tidymodels</code> har funktionen <code>initial_split</code>, der opdeler datasættet således at fk. 75% af observationerne hører til det “training” sæt og 25% hører til det “testing” sæt:</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="maskinslæring-i-tidyverse.html#cb620-1" aria-hidden="true" tabindex="-1"></a>penguins_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(penguins, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb620-2"><a href="maskinslæring-i-tidyverse.html#cb620-2" aria-hidden="true" tabindex="-1"></a>penguins_split</span></code></pre></div>
<pre><code>## &lt;Analysis/Assess/Total&gt;
## &lt;249/84/333&gt;</code></pre>
<p>Det betyder, at ud af de 333 observationerne, bliver 249 brugt som “training” og 84 er beholdt tilbage som en “testing” sæt. Jeg udtrækker bagefter de to sæt til at få “penguins_training” og “penguins_test” som i følgende:</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="maskinslæring-i-tidyverse.html#cb622-1" aria-hidden="true" tabindex="-1"></a>penguins_training <span class="ot">&lt;-</span> penguins_split <span class="sc">%&gt;%</span> <span class="fu">training</span>()</span>
<span id="cb622-2"><a href="maskinslæring-i-tidyverse.html#cb622-2" aria-hidden="true" tabindex="-1"></a>penguins_test <span class="ot">&lt;-</span> penguins_split <span class="sc">%&gt;%</span> <span class="fu">testing</span>()</span></code></pre></div>
<p>Jeg vil gerne anvende <code>penguins_training</code> til at opbygge modellen og så kun kigge på <code>penguins_test</code> senere for at evaluere modellens evne til at lave forudsigelser.</p>
</div>
<div id="cross-fold-validation" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Cross-fold validation<a href="maskinslæring-i-tidyverse.html#cross-fold-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For at udvikle min model med mit træning datasæt anvender jeg “5-cross-fold-validation”. I 5-fold-cross-validation splitte man et datasæt op i 5 stykker (“folds”). Man træner dernæst en model på 4 af de 5 stykker (folds), og tester på den sidste stykke (der ofte kaldes for “validation” sæt, og som ikke selv var en del af datasættet brugte til at fitte selve modellen). Man gentager model “training” processen i alt fem gange, hvor hvert styk er brugt præcis én gang som “valiation” sæt.</p>
<p><img src="plots/machine_step1_step2.png" width="100%" /></p>
<p>Tilgangen har mange fordele. Hvis der var for eksempel kun én testing sæt og ved tilfældighed har den sæt observationer som er især nemme at forudsige, så får vi en fejlagtig fornemmelse at modellen er bedre end den er i virkeligheden - vi undgår det vi at bruge 5 forskellige validation sæt som dækker hele træning sæt. Vi kan således lede efter en kommination af parametre, der konsekvent giver en god model over samtlig validation sæt - vi kan være mere sikker på at få en model, der virker godt i vores testing sæt til sidste.</p>
<!-- * Man kan få en fornemmelse af hvor meget hvors evne til at forudsige på nye data variare afhængig af observatiorene der ligger i enten testing eller træning sæt. -->
<!-- * Minimire "overfitting" modellen - det vil sige, at modellen er meget godt til at forstå hvad der sker i datasættet men dårlig til at forudsige hvad der forgår med hensyn til nye observationer. -->
<p>Der er en nem funktion man kan bruge i <code>rsample</code>-pakken, der hedder <code>vfold_cv</code> til at lave cross validation. Her angiver jeg <code>v=5</code> for at vise, at jeg gerne vil have 5-folds.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="maskinslæring-i-tidyverse.html#cb623-1" aria-hidden="true" tabindex="-1"></a>cv_split <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(penguins_training, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb623-2"><a href="maskinslæring-i-tidyverse.html#cb623-2" aria-hidden="true" tabindex="-1"></a>cv_split</span></code></pre></div>
<pre><code>## #  5-fold cross-validation 
## # A tibble: 5 × 2
##   splits           id   
##   &lt;list&gt;           &lt;chr&gt;
## 1 &lt;split [199/50]&gt; Fold1
## 2 &lt;split [199/50]&gt; Fold2
## 3 &lt;split [199/50]&gt; Fold3
## 4 &lt;split [199/50]&gt; Fold4
## 5 &lt;split [200/49]&gt; Fold5</code></pre>
<p>Så kan man se, at vi får en dataframe med 5 datasæt som er lagret i kolonnen <code>splits</code>. Jeg vil gerne udtrække de forskellige “training” og “testing”(/“validate”) sæt ud i deres egne kolonner, som i følgende med <code>map</code> indenfor <code>mutate</code>:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="maskinslæring-i-tidyverse.html#cb625-1" aria-hidden="true" tabindex="-1"></a>cv_data <span class="ot">&lt;-</span> cv_split <span class="sc">%&gt;%</span> </span>
<span id="cb625-2"><a href="maskinslæring-i-tidyverse.html#cb625-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb625-3"><a href="maskinslæring-i-tidyverse.html#cb625-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">train =</span> <span class="fu">map</span>(splits, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> training), <span class="co">#extract training datasets</span></span>
<span id="cb625-4"><a href="maskinslæring-i-tidyverse.html#cb625-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">validate =</span> <span class="fu">map</span>(splits, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> testing) <span class="co">#extract validation datasets</span></span>
<span id="cb625-5"><a href="maskinslæring-i-tidyverse.html#cb625-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb625-6"><a href="maskinslæring-i-tidyverse.html#cb625-6" aria-hidden="true" tabindex="-1"></a>cv_data</span></code></pre></div>
<pre><code>## #  5-fold cross-validation 
## # A tibble: 5 × 4
##   splits           id    train              validate         
##   &lt;list&gt;           &lt;chr&gt; &lt;list&gt;             &lt;list&gt;           
## 1 &lt;split [199/50]&gt; Fold1 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt;
## 2 &lt;split [199/50]&gt; Fold2 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt;
## 3 &lt;split [199/50]&gt; Fold3 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt;
## 4 &lt;split [199/50]&gt; Fold4 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt;
## 5 &lt;split [200/49]&gt; Fold5 &lt;tibble [200 × 8]&gt; &lt;tibble [49 × 8]&gt;</code></pre>
</div>
<div id="bygge-modellen-og-lave-forudsigelser" class="section level3 hasAnchor" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Bygge modellen og lave forudsigelser<a href="maskinslæring-i-tidyverse.html#bygge-modellen-og-lave-forudsigelser" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi vil gerne lave en model på alle vores datasæt i kolonnen <code>train</code> hver for sig, og forudgsige <code>body_mass_g</code> i hvert tilknyttet validation sæt. Vi kan gøre det med en custom funktion som i følgende:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="maskinslæring-i-tidyverse.html#cb627-1" aria-hidden="true" tabindex="-1"></a>my_lm_func <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">lm</span>(body_mass_g <span class="sc">~</span> ., <span class="at">data =</span> .x) <span class="co"># . betyder alle variabler i .x er uafhængige untaget body_mass_g</span></span>
<span id="cb627-2"><a href="maskinslæring-i-tidyverse.html#cb627-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-3"><a href="maskinslæring-i-tidyverse.html#cb627-3" aria-hidden="true" tabindex="-1"></a>cv_models_lm <span class="ot">&lt;-</span> cv_data <span class="sc">%&gt;%</span> </span>
<span id="cb627-4"><a href="maskinslæring-i-tidyverse.html#cb627-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(train, my_lm_func))</span>
<span id="cb627-5"><a href="maskinslæring-i-tidyverse.html#cb627-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-6"><a href="maskinslæring-i-tidyverse.html#cb627-6" aria-hidden="true" tabindex="-1"></a>cv_models_lm</span></code></pre></div>
<pre><code>## #  5-fold cross-validation 
## # A tibble: 5 × 5
##   splits           id    train              validate          model 
##   &lt;list&gt;           &lt;chr&gt; &lt;list&gt;             &lt;list&gt;            &lt;list&gt;
## 1 &lt;split [199/50]&gt; Fold1 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt; &lt;lm&gt;  
## 2 &lt;split [199/50]&gt; Fold2 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt; &lt;lm&gt;  
## 3 &lt;split [199/50]&gt; Fold3 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt; &lt;lm&gt;  
## 4 &lt;split [199/50]&gt; Fold4 &lt;tibble [199 × 8]&gt; &lt;tibble [50 × 8]&gt; &lt;lm&gt;  
## 5 &lt;split [200/49]&gt; Fold5 &lt;tibble [200 × 8]&gt; &lt;tibble [49 × 8]&gt; &lt;lm&gt;</code></pre>
<p>Nu vil vi gerne bruge datasættet i kolonnen <code>validate</code> til at lave en forudsigelse til hver af vores modeller. Til det formål kan man bruge funktionen <code>predict()</code> - man tager en model samt et nye datasæt (dvs. tilsvarende datasæt i kolonne validate), og så få nogle forventede <code>body_mass_g</code> værdier ud fra modellen anvendte på de nye data. I følgende bliver disse forventede “predicted” værdier til <code>body_mass_g</code> lagret i kolonnen <code>validate_predicted</code>. Da vi faktisk vide de virkelige værdier til <code>body_mass_g</code> i vores validation datasæt laver jeg også en kolonne <code>validate_actual</code> som er disse virkelige værdier, som jeg kan sammenligne med mine forventede værdier.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="maskinslæring-i-tidyverse.html#cb629-1" aria-hidden="true" tabindex="-1"></a>cv_prep_lm <span class="ot">&lt;-</span> cv_models_lm <span class="sc">%&gt;%</span> </span>
<span id="cb629-2"><a href="maskinslæring-i-tidyverse.html#cb629-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb629-3"><a href="maskinslæring-i-tidyverse.html#cb629-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_mass =</span> <span class="fu">map</span>(validate, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(body_mass_g)), <span class="co">#actual body_mass_g values for validation set</span></span>
<span id="cb629-4"><a href="maskinslæring-i-tidyverse.html#cb629-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted_mass =</span> <span class="fu">map2</span>(<span class="at">.x =</span> model, <span class="at">.y =</span> validate, <span class="sc">~</span><span class="fu">predict</span>(.x, .y)) <span class="co">#predicted body_mass_g values for validation set</span></span>
<span id="cb629-5"><a href="maskinslæring-i-tidyverse.html#cb629-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="vurdere-resultater-på-validation-sæt" class="section level3 hasAnchor" number="12.3.4">
<h3><span class="header-section-number">12.3.4</span> Vurdere resultater på validation sæt<a href="maskinslæring-i-tidyverse.html#vurdere-resultater-på-validation-sæt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jeg vil gerne sammenligne mine nye forudsigelser direkte med mine virkelige værdier til <code>body_mass_g</code>, hvilket kan give os en indikation på, hvor godt vores modeller egentlig er. I følgende tager jeg <code>id</code>, <code>actual_mass</code> og <code>predict_mass</code> ud fra dataframen <code>cv_pred_lm</code> og gennem dem i en ny dataframe <code>prediction_df</code>:</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="maskinslæring-i-tidyverse.html#cb630-1" aria-hidden="true" tabindex="-1"></a>prediction_df <span class="ot">&lt;-</span> cv_prep_lm <span class="sc">%&gt;%</span> <span class="fu">select</span>(id,actual_mass,predicted_mass) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(<span class="fu">c</span>(actual_mass,predicted_mass))</span></code></pre></div>
<p>Til hver af de fem folds bregener jeg statisttiken “mean absolute error” der tager afstanden mellem de forventede værdier (<code>predicted_mass</code>) og virkelige værdier (<code>actual_mass</code>) og tager dernæst middelværdien (over deres absolute værdier dvs. uden minus tegn). Jo mindre “mae” er, jo bedre modellen ser ud.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="maskinslæring-i-tidyverse.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="co">#smaller mae = better model</span></span>
<span id="cb631-2"><a href="maskinslæring-i-tidyverse.html#cb631-2" aria-hidden="true" tabindex="-1"></a>mae_df <span class="ot">&lt;-</span> prediction_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="st">&quot;mae&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(actual_mass<span class="sc">-</span>predicted_mass)))</span></code></pre></div>
<p>Her er et plot af statistikken “mae” til de forskellige folds. I gennemsnit er det 233.0974471, der betyder at vores forudsigelser er ude/forkert ved knap 300 g i gennemsnit - ikke dårligt når den gennemsnits pingvin vejer 4207.06 g.</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="maskinslæring-i-tidyverse.html#cb632-1" aria-hidden="true" tabindex="-1"></a>mae_df <span class="sc">%&gt;%</span> </span>
<span id="cb632-2"><a href="maskinslæring-i-tidyverse.html#cb632-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>mae,<span class="at">x=</span>id,<span class="at">fill=</span>id)) <span class="sc">+</span> </span>
<span id="cb632-3"><a href="maskinslæring-i-tidyverse.html#cb632-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb632-4"><a href="maskinslæring-i-tidyverse.html#cb632-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-648-1.png" width="480" /></p>
</div>
<div id="teste-og-evaluere-final-model" class="section level3 hasAnchor" number="12.3.5">
<h3><span class="header-section-number">12.3.5</span> Teste og evaluere “final” model<a href="maskinslæring-i-tidyverse.html#teste-og-evaluere-final-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi har lavet forudsigelser over de forskellige stykker i vores træning sæt, men vi har ikke endnu lavet forudsigelser på vores testing sæt <code>penguins_test</code>, som blev holdt ud af hele træningsprocessen. Efter den cross-validation proces skal man lave en “final” model, der bruger samtlige training data på én gang (dvs. ikke bare en enkel fold, der vi gerne vil opbygge den endelige model fra så meget data, som muligt. Bemærk at når det er kun et datasæt, behøver vi ikke at bruge en custom funktion.</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="maskinslæring-i-tidyverse.html#cb633-1" aria-hidden="true" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> ., <span class="at">data =</span> penguins_training)</span></code></pre></div>
<p>Nu kan vi endelige anvende vores testing data (som vi holdt ud før cross-validaiton processen): her anvender jeg min “final model” til at forudsige <code>body_mass_g</code> på pingvinerne i datasættet <code>penguins_test</code>. Dernæst sammenligner vi vores forudsigelser med den virkelige værdier ligesom i ovenstående (men her har jeg ikke forskellige folds at tage i betragtning).</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="maskinslæring-i-tidyverse.html#cb634-1" aria-hidden="true" tabindex="-1"></a>prediction_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;actual_mass&quot;</span><span class="ot">=</span>penguins_test <span class="sc">%&gt;%</span> <span class="fu">pull</span>(body_mass_g),</span>
<span id="cb634-2"><a href="maskinslæring-i-tidyverse.html#cb634-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;predicted_mass&quot;</span><span class="ot">=</span><span class="fu">predict</span>(model_final,penguins_test))</span>
<span id="cb634-3"><a href="maskinslæring-i-tidyverse.html#cb634-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-4"><a href="maskinslæring-i-tidyverse.html#cb634-4" aria-hidden="true" tabindex="-1"></a>prediction_df <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="st">&quot;mae&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(actual_mass<span class="sc">-</span>predicted_mass)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     mae
##   &lt;dbl&gt;
## 1  235.</code></pre>
<p>Man kan se, at vores final model lave forudsigelser som er i gennemsnit 235.5g væk fra pingvinernes virkelige vægt (det vil sige, at forudsigelsen kan være over eller under den virkelige værdi, men i gennemsnit er afstanden fra den virkelige værdi 230g).</p>
</div>
</div>
<div id="classification-models" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Classification models<a href="maskinslæring-i-tidyverse.html#classification-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I ovenstående proces lavede vi en regression model, hvor afhængig variabel er kontinuerly (<code>body_mass_g</code>). I en classification model er den afhængig variabel kategorisk (fk. “yes” eller “no” i forhold til variblen <code>Survived</code> i datasættet <code>titanic</code>). Vi viser her at det er meget nemt at skifte fra den ene type model til en anden og bruger stort set samme kode (kun små ændringer).</p>
<p>Ovenstående ramme også giver os muligheden for at opbygge modeller, hvor der faktisk er forskellige parametre, der skal vælges. I ovenstående eksempel med penguins var der faktisk ikke meget “tuning” vi skulle lave for at udvikle modellen. Jeg viser her hvordan man kan “tune” en parameter indenfor samme ramme i vores classification model.</p>
<p>Jeg åbner først titanic datasæt. Datasættet i <code>titanic</code>-pakken er allerede blevet adskilt efter training og testing men lad os bare ignorerer det og følger samme ramme som i ovenstående.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="maskinslæring-i-tidyverse.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(titanic)</span>
<span id="cb636-2"><a href="maskinslæring-i-tidyverse.html#cb636-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb636-3"><a href="maskinslæring-i-tidyverse.html#cb636-3" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic_train</span>
<span id="cb636-4"><a href="maskinslæring-i-tidyverse.html#cb636-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb636-5"><a href="maskinslæring-i-tidyverse.html#cb636-5" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb636-6"><a href="maskinslæring-i-tidyverse.html#cb636-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">Survived =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(Survived <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb636-7"><a href="maskinslæring-i-tidyverse.html#cb636-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">Pclass =</span> <span class="fu">recode</span>(Pclass, <span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;first&quot;</span>,<span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;second&quot;</span>,<span class="st">`</span><span class="at">3</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;third&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb636-8"><a href="maskinslæring-i-tidyverse.html#cb636-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">Pclass =</span> <span class="fu">as_factor</span>(Pclass),</span>
<span id="cb636-9"><a href="maskinslæring-i-tidyverse.html#cb636-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sex =</span> <span class="fu">as_factor</span>(Sex),</span>
<span id="cb636-10"><a href="maskinslæring-i-tidyverse.html#cb636-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Port =</span> <span class="fu">as_factor</span>(Embarked),</span>
<span id="cb636-11"><a href="maskinslæring-i-tidyverse.html#cb636-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Solo =</span> <span class="fu">if_else</span>(SibSp <span class="sc">+</span> Parch <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb636-12"><a href="maskinslæring-i-tidyverse.html#cb636-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(Survived, Pclass, Sex, Age, Solo, Port, Fare)</span>
<span id="cb636-13"><a href="maskinslæring-i-tidyverse.html#cb636-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb636-14"><a href="maskinslæring-i-tidyverse.html#cb636-14" aria-hidden="true" tabindex="-1"></a>titanic</span></code></pre></div>
<pre><code>## # A tibble: 714 × 7
##    Survived Pclass Sex      Age Solo  Port   Fare
##    &lt;fct&gt;    &lt;fct&gt;  &lt;fct&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;fct&gt; &lt;dbl&gt;
##  1 no       third  male      22 no    S      7.25
##  2 yes      first  female    38 no    C     71.3 
##  3 yes      third  female    26 yes   S      7.92
##  4 yes      first  female    35 no    S     53.1 
##  5 no       third  male      35 yes   S      8.05
##  6 no       first  male      54 yes   S     51.9 
##  7 no       third  male       2 no    S     21.1 
##  8 yes      third  female    27 no    S     11.1 
##  9 yes      second female    14 no    C     30.1 
## 10 yes      third  female     4 no    S     16.7 
## # … with 704 more rows</code></pre>
<p>Her vil vi gerne forudsige hvem der overlevede, og hvem der ikke overlevede. Det er et eksempel på et “classification” problem, hvor der er to mulige svar (“yes” eller “no”) og man gerne vil beregne sandsynlighed for de to muligheder. Det er hvad der kaldes for et “supervisered” problem, fordi når vi træner modellen, ved vi faktisk hvem der overlevede i datasættet. Det er til forskel for eksempelvis kmeans clustering, hvor vi ikke har svaret i forvejen (men bare kan gætte, at de forskellige clusters relatere til noget, for eksempel hvilke species en observation hører til).</p>
<p>Før vi går i gang, her er et overblik over processen med at opbygge modellen med titanic:</p>
<p><img src="plots/machine_learning_diagram.png" width="100%" /></p>
<p>I følgende steps forklarer jeg processen med <code>titanic</code> i flere detaljer:</p>
<div id="splitte-datasættet-og-lave-cross-validation-dataframe" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Splitte datasættet og lave cross-validation dataframe<a href="maskinslæring-i-tidyverse.html#splitte-datasættet-og-lave-cross-validation-dataframe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="maskinslæring-i-tidyverse.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb638-2"><a href="maskinslæring-i-tidyverse.html#cb638-2" aria-hidden="true" tabindex="-1"></a>titanic_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(titanic, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb638-3"><a href="maskinslæring-i-tidyverse.html#cb638-3" aria-hidden="true" tabindex="-1"></a>titanic_training <span class="ot">&lt;-</span> titanic_split <span class="sc">%&gt;%</span> <span class="fu">training</span>()</span>
<span id="cb638-4"><a href="maskinslæring-i-tidyverse.html#cb638-4" aria-hidden="true" tabindex="-1"></a>titanic_test <span class="ot">&lt;-</span> titanic_split <span class="sc">%&gt;%</span> <span class="fu">testing</span>()</span></code></pre></div>
<p>Vi anvender 5-fold cross validation på datasættet <code>titanic_training</code> og udtrækker de træning og testing sæt til de forskellige folds (og lagrer dem i henholdvis <code>train</code> og <code>validate</code> i dataframen <code>cv_data</code>):</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="maskinslæring-i-tidyverse.html#cb639-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb639-2"><a href="maskinslæring-i-tidyverse.html#cb639-2" aria-hidden="true" tabindex="-1"></a>cv_split <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(titanic_training, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb639-3"><a href="maskinslæring-i-tidyverse.html#cb639-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb639-4"><a href="maskinslæring-i-tidyverse.html#cb639-4" aria-hidden="true" tabindex="-1"></a>cv_data <span class="ot">&lt;-</span> cv_split <span class="sc">%&gt;%</span> </span>
<span id="cb639-5"><a href="maskinslæring-i-tidyverse.html#cb639-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb639-6"><a href="maskinslæring-i-tidyverse.html#cb639-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">train =</span> <span class="fu">map</span>(splits, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">training</span>()), </span>
<span id="cb639-7"><a href="maskinslæring-i-tidyverse.html#cb639-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">validate =</span> <span class="fu">map</span>(splits, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">testing</span>())</span>
<span id="cb639-8"><a href="maskinslæring-i-tidyverse.html#cb639-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb639-9"><a href="maskinslæring-i-tidyverse.html#cb639-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb639-10"><a href="maskinslæring-i-tidyverse.html#cb639-10" aria-hidden="true" tabindex="-1"></a>cv_data</span></code></pre></div>
<pre><code>## #  5-fold cross-validation 
## # A tibble: 5 × 4
##   splits            id    train              validate          
##   &lt;list&gt;            &lt;chr&gt; &lt;list&gt;             &lt;list&gt;            
## 1 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;
## 2 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;
## 3 &lt;split [428/107]&gt; Fold3 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;
## 4 &lt;split [428/107]&gt; Fold4 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;
## 5 &lt;split [428/107]&gt; Fold5 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;</code></pre>
</div>
<div id="definere-classification-model" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Definere classification model<a href="maskinslæring-i-tidyverse.html#definere-classification-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Næste vil vi gerne anvende en model over de fem training sæt. Et godt eksempel på en classifikation metode som er både nem at bruge og meget kræftig er en “random forest”. Her er det ikke nødvendeigt at forstå al detaljer, men helt kort - man opbygger beslutningstræer baserede på tilfældigt udvalgte subsets af data. I et beslutningstræ laver man “splits” over de forskellige variabler, som man bruger for at bestemme, om en passagerer overlevede eller ej (se billede). Når man kan gøre samme process flere gange, over eksempelvis 100 træer, der involverer 100 tilfældige subsæt af data, kan man tage et gennemsnit, som udgør de endelige beslutninger (predictions eller forudsigelser).</p>
<p><img src="plots/random_forest_titanic.png" width="70%" /></p>
<p>I følgende anvender jeg funktionen <code>ranger()</code> (installer pakken <code>ranger</code>), der fitter en random forest i R på datasætet.</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="maskinslæring-i-tidyverse.html#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb641-2"><a href="maskinslæring-i-tidyverse.html#cb641-2" aria-hidden="true" tabindex="-1"></a>ranger_model <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">ranger</span>(<span class="at">formula =</span> Survived <span class="sc">~</span> . ,  <span class="co"># . betyder all variabler i datasættet som uafhængig</span></span>
<span id="cb641-3"><a href="maskinslæring-i-tidyverse.html#cb641-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">data =</span> .x,</span>
<span id="cb641-4"><a href="maskinslæring-i-tidyverse.html#cb641-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">num.trees =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>Lidt om <code>ranger</code>-modellens parametre:</p>
<ul>
<li>Jeg angiver en formel - variablen <code>Survived</code> er afhængig og alle andre variabler er uafhængig (betegnet ved “.” for at spare tid).</li>
<li>data er <code>.x</code> og referer til en træning sæt til én af vores “folds” i vores cross-fold validation datasæt.</li>
<li><code>num.trees</code> fortæller, hvor mange træer jeg vil lave (jo mere jo bedre, men der er en trade-off med hensyn til tid/energi)</li>
</ul>
</div>
<div id="anvende-modellen-og-lave-predictions" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Anvende modellen og lave predictions<a href="maskinslæring-i-tidyverse.html#anvende-modellen-og-lave-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Jeg laver mine modeller ved at oprette en ny kolonne <code>model</code> i dataframe <code>cv_data</code>, hvor jeg anvender min custom funktion med <code>map</code>:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="maskinslæring-i-tidyverse.html#cb642-1" aria-hidden="true" tabindex="-1"></a>cv_models_rf <span class="ot">&lt;-</span> cv_data <span class="sc">%&gt;%</span> </span>
<span id="cb642-2"><a href="maskinslæring-i-tidyverse.html#cb642-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(train, ranger_model))</span>
<span id="cb642-3"><a href="maskinslæring-i-tidyverse.html#cb642-3" aria-hidden="true" tabindex="-1"></a>cv_models_rf</span></code></pre></div>
<pre><code>## #  5-fold cross-validation 
## # A tibble: 5 × 5
##   splits            id    train              validate           model   
##   &lt;list&gt;            &lt;chr&gt; &lt;list&gt;             &lt;list&gt;             &lt;list&gt;  
## 1 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt; &lt;ranger&gt;
## 2 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt; &lt;ranger&gt;
## 3 &lt;split [428/107]&gt; Fold3 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt; &lt;ranger&gt;
## 4 &lt;split [428/107]&gt; Fold4 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt; &lt;ranger&gt;
## 5 &lt;split [428/107]&gt; Fold5 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt; &lt;ranger&gt;</code></pre>
<p>Næste laver jeg forudsigelser over de fem <code>validate</code> datasæt med funktionen <code>predict()</code> - det fungere på samme måde som i ovenstående regression model, men med <code>ranger</code> er man nødt til at udtrække selve forudsigelserne ved at tilføje <code>$predictions</code>, ligesom i følgende funktion <code>my_prediction_function</code>:</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="maskinslæring-i-tidyverse.html#cb644-1" aria-hidden="true" tabindex="-1"></a>my_prediction_function <span class="ot">&lt;-</span>  <span class="er">~</span><span class="fu">predict</span>(.x, .y)<span class="sc">$</span>predictions</span>
<span id="cb644-2"><a href="maskinslæring-i-tidyverse.html#cb644-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-3"><a href="maskinslæring-i-tidyverse.html#cb644-3" aria-hidden="true" tabindex="-1"></a>cv_prep_rf <span class="ot">&lt;-</span> cv_models_rf <span class="sc">%&gt;%</span> </span>
<span id="cb644-4"><a href="maskinslæring-i-tidyverse.html#cb644-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb644-5"><a href="maskinslæring-i-tidyverse.html#cb644-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual =</span> <span class="fu">map</span>(validate, <span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Survived)), <span class="co">#virkelig &quot;yes&quot; eller &quot;no&quot;</span></span>
<span id="cb644-6"><a href="maskinslæring-i-tidyverse.html#cb644-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">map2</span>(<span class="at">.x =</span> model, <span class="at">.y =</span> validate,my_prediction_function) <span class="co">#forudsigelser af &quot;yes&quot; eller &quot;no&quot;</span></span>
<span id="cb644-7"><a href="maskinslæring-i-tidyverse.html#cb644-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Nu lad os kigge på vores forudsigelser (“yes” eller “no”) ved siden af de virkelige værdier (“yes” eller “no”) i variablen <code>Survived</code>, for hver af de fem validation sæt:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="maskinslæring-i-tidyverse.html#cb645-1" aria-hidden="true" tabindex="-1"></a>predictions_df <span class="ot">&lt;-</span> cv_prep_rf <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, actual,predicted) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(<span class="fu">c</span>(actual,predicted)) </span>
<span id="cb645-2"><a href="maskinslæring-i-tidyverse.html#cb645-2" aria-hidden="true" tabindex="-1"></a>predictions_df</span></code></pre></div>
<pre><code>## # A tibble: 535 × 3
##    id    actual predicted
##    &lt;chr&gt; &lt;fct&gt;  &lt;fct&gt;    
##  1 Fold1 yes    yes      
##  2 Fold1 yes    yes      
##  3 Fold1 no     no       
##  4 Fold1 yes    yes      
##  5 Fold1 no     no       
##  6 Fold1 yes    yes      
##  7 Fold1 yes    no       
##  8 Fold1 no     no       
##  9 Fold1 yes    yes      
## 10 Fold1 yes    yes      
## # … with 525 more rows</code></pre>
</div>
<div id="beregne-accuracy" class="section level3 hasAnchor" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> Beregne accuracy<a href="maskinslæring-i-tidyverse.html#beregne-accuracy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hvor mange fik vi rigtige? Vi beregner “accuracy” som måler proportionen af “rigtig” forudsigelser (både <code>actual</code> og <code>predicted</code> er enige om, hvem der overlevede eller ikke overlevede). Da jeg har forudsigelser til 5 forskellige datasæt (validation sæt for hver “fold”), anvender jeg <code>group_by(id)</code>, og dernæst <code>summary</code> til at beregne proportionen af tilfælde variablen <code>actual</code> er den samme som <code>predicted</code>.</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="maskinslæring-i-tidyverse.html#cb647-1" aria-hidden="true" tabindex="-1"></a>my_accuracies <span class="ot">&lt;-</span> predictions_df <span class="sc">%&gt;%</span> </span>
<span id="cb647-2"><a href="maskinslæring-i-tidyverse.html#cb647-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb647-3"><a href="maskinslæring-i-tidyverse.html#cb647-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;accuracy&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(actual<span class="sc">==</span>predicted)<span class="sc">/</span><span class="fu">n</span>())</span>
<span id="cb647-4"><a href="maskinslæring-i-tidyverse.html#cb647-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-5"><a href="maskinslæring-i-tidyverse.html#cb647-5" aria-hidden="true" tabindex="-1"></a>my_accuracies</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   id    accuracy
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 Fold1    0.738
## 2 Fold2    0.813
## 3 Fold3    0.841
## 4 Fold4    0.822
## 5 Fold5    0.813</code></pre>
<p>Jeg kan omsætte tallene til et plot:</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="maskinslæring-i-tidyverse.html#cb649-1" aria-hidden="true" tabindex="-1"></a>my_accuracies <span class="sc">%&gt;%</span> </span>
<span id="cb649-2"><a href="maskinslæring-i-tidyverse.html#cb649-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>id,<span class="at">y=</span>accuracy,<span class="at">fill=</span>id)) <span class="sc">+</span>  </span>
<span id="cb649-3"><a href="maskinslæring-i-tidyverse.html#cb649-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb649-4"><a href="maskinslæring-i-tidyverse.html#cb649-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-661-1.png" width="480" /></p>
</div>
<div id="parameter-tuning" class="section level3 hasAnchor" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> Parameter tuning<a href="maskinslæring-i-tidyverse.html#parameter-tuning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I funktionen <code>ranger</code> var der faktisk nogle parametre som kan have indfyldelse over modellens predictions til sidste - én af dem er for eksempel <code>num.trees</code> - hvis man bruger fk. 100 træer får man sandsynligvis bedre resultater end hvis man anvender kun et træ. En anden parameter, som vi angav som “default” i ovenståene analyse er <code>mtry</code>. Det fortæller hvor mange variabler vi skal inddrage i en enkel beregning i træerne (det inddrager mere tilfældighed i altgoritmen og undgår, at 1-2 variabler har for meget indfyldelse på resulaterne).
Vi vil gerne prøve de forskellige værdier til <code>mtry</code> i modellen og se, hvilken værdi giver bedste resultater. I <code>tidyr</code>-pakken er der en nyttig funktion <code>crossing</code>, der laver kopier af de forskellige folds datasæt, én til hver mulig værdie af <code>mtry</code>:</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="maskinslæring-i-tidyverse.html#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for tuning your cross validation folds by varying mtry</span></span>
<span id="cb650-2"><a href="maskinslæring-i-tidyverse.html#cb650-2" aria-hidden="true" tabindex="-1"></a>cv_tune <span class="ot">&lt;-</span> cv_data <span class="sc">%&gt;%</span></span>
<span id="cb650-3"><a href="maskinslæring-i-tidyverse.html#cb650-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb650-4"><a href="maskinslæring-i-tidyverse.html#cb650-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-5"><a href="maskinslæring-i-tidyverse.html#cb650-5" aria-hidden="true" tabindex="-1"></a>cv_tune</span></code></pre></div>
<pre><code>## # A tibble: 25 × 5
##    splits            id    train              validate            mtry
##    &lt;list&gt;            &lt;chr&gt; &lt;list&gt;             &lt;list&gt;             &lt;int&gt;
##  1 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     2
##  2 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     3
##  3 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     4
##  4 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     5
##  5 &lt;split [428/107]&gt; Fold1 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     6
##  6 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     2
##  7 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     3
##  8 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     4
##  9 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     5
## 10 &lt;split [428/107]&gt; Fold2 &lt;tibble [428 × 7]&gt; &lt;tibble [107 × 7]&gt;     6
## # … with 15 more rows</code></pre>
<p>Nu kan jeg bygge en model op til hver kombination af fold (variablen <code>id</code>) og mtry (variablen <code>mtry</code>). Bemærk at jeg bruger <code>map2</code> her, der jeg gerne vil bruge to kolonner af min næsted dataframe - <code>mtry</code> (betegnet som .y i funktionen) og <code>train</code> (betegnet som .x i funktionen).</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="maskinslæring-i-tidyverse.html#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a model for each fold &amp; mtry combination</span></span>
<span id="cb652-2"><a href="maskinslæring-i-tidyverse.html#cb652-2" aria-hidden="true" tabindex="-1"></a>my_ranger_func <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">ranger</span>(<span class="at">formula =</span> Survived<span class="sc">~</span>., <span class="at">data =</span> .x, </span>
<span id="cb652-3"><a href="maskinslæring-i-tidyverse.html#cb652-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mtry =</span> .y,</span>
<span id="cb652-4"><a href="maskinslæring-i-tidyverse.html#cb652-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">num.trees =</span> <span class="dv">100</span>)</span>
<span id="cb652-5"><a href="maskinslæring-i-tidyverse.html#cb652-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-6"><a href="maskinslæring-i-tidyverse.html#cb652-6" aria-hidden="true" tabindex="-1"></a>cv_models_rf <span class="ot">&lt;-</span> cv_tune <span class="sc">%&gt;%</span> </span>
<span id="cb652-7"><a href="maskinslæring-i-tidyverse.html#cb652-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map2</span>(train, mtry, my_ranger_func))</span></code></pre></div>
<p>Og utrækker predictions med <code>predict</code> ligesom i ovenstående:</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="maskinslæring-i-tidyverse.html#cb653-1" aria-hidden="true" tabindex="-1"></a>cv_prep_rf <span class="ot">&lt;-</span> cv_models_rf <span class="sc">%&gt;%</span> </span>
<span id="cb653-2"><a href="maskinslæring-i-tidyverse.html#cb653-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb653-3"><a href="maskinslæring-i-tidyverse.html#cb653-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual =</span> <span class="fu">map</span>(validate, <span class="sc">~</span>.x<span class="sc">$</span>Survived),</span>
<span id="cb653-4"><a href="maskinslæring-i-tidyverse.html#cb653-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> <span class="fu">map2</span>(<span class="at">.x =</span> model, <span class="at">.y =</span> validate, <span class="sc">~</span><span class="fu">predict</span>(.x, .y)<span class="sc">$</span>predictions)</span>
<span id="cb653-5"><a href="maskinslæring-i-tidyverse.html#cb653-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Nu laver jeg en dataframe ligesom i ovenstående som viser mine predictions - men denne gange har jeg predictions over både min folds og de forskellige værdier for “mtry”:</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="maskinslæring-i-tidyverse.html#cb654-1" aria-hidden="true" tabindex="-1"></a>predictions_df <span class="ot">&lt;-</span> cv_prep_rf <span class="sc">%&gt;%</span> <span class="fu">select</span>(id,mtry,actual,predicted) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(<span class="at">cols=</span><span class="fu">c</span>(actual,predicted))</span>
<span id="cb654-2"><a href="maskinslæring-i-tidyverse.html#cb654-2" aria-hidden="true" tabindex="-1"></a>predictions_df</span></code></pre></div>
<pre><code>## # A tibble: 2,675 × 4
##    id     mtry actual predicted
##    &lt;chr&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt;    
##  1 Fold1     2 yes    yes      
##  2 Fold1     2 yes    yes      
##  3 Fold1     2 no     no       
##  4 Fold1     2 yes    yes      
##  5 Fold1     2 no     no       
##  6 Fold1     2 yes    yes      
##  7 Fold1     2 yes    no       
##  8 Fold1     2 no     no       
##  9 Fold1     2 yes    yes      
## 10 Fold1     2 yes    yes      
## # … with 2,665 more rows</code></pre>
<p>Jeg anvender <code>group_by</code> efter både <code>mtry</code> og <code>id</code> for at beregne accuracy:</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="maskinslæring-i-tidyverse.html#cb656-1" aria-hidden="true" tabindex="-1"></a>my_accuracies <span class="ot">&lt;-</span> predictions_df <span class="sc">%&gt;%</span> </span>
<span id="cb656-2"><a href="maskinslæring-i-tidyverse.html#cb656-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mtry,id) <span class="sc">%&gt;%</span> </span>
<span id="cb656-3"><a href="maskinslæring-i-tidyverse.html#cb656-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;accuracy&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(actual<span class="sc">==</span>predicted)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb656-4"><a href="maskinslæring-i-tidyverse.html#cb656-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>(mtry)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;mtry&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>I følgende plot visualiseres den sammenlagt accuracy over all folds, til hver mulig værdi af “mtry”-parameteren. Man kan se, at det gør ikke meget forskel, hvilken værdie af “mtry” jeg vælger i min final moodel, min den højeste sammenlagt søjle hører til “mtry=3” - så jeg tager 3 som min “mtry” parameter i min “final” model.</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="maskinslæring-i-tidyverse.html#cb658-1" aria-hidden="true" tabindex="-1"></a>my_accuracies <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>id,<span class="at">x=</span>mtry,<span class="at">y=</span>accuracy)) <span class="sc">+</span> </span>
<span id="cb658-2"><a href="maskinslæring-i-tidyverse.html#cb658-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb658-3"><a href="maskinslæring-i-tidyverse.html#cb658-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;total accuracy over all folds&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Total accuracy stacked up over the 5 folds&quot;</span>) <span class="sc">+</span></span>
<span id="cb658-4"><a href="maskinslæring-i-tidyverse.html#cb658-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-667-1.png" width="384" /></p>
</div>
<div id="lave-final-model-med-titanic-datasæt" class="section level3 hasAnchor" number="12.4.6">
<h3><span class="header-section-number">12.4.6</span> Lave final model med titanic datasæt<a href="maskinslæring-i-tidyverse.html#lave-final-model-med-titanic-datasæt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I min final model anvender jeg parametrene jeg valgt i min cross-validation proces, og træner jeg min model over hele <code>titanic_training</code> datasæt på én gang.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="maskinslæring-i-tidyverse.html#cb659-1" aria-hidden="true" tabindex="-1"></a>final_RF <span class="ot">&lt;-</span> <span class="fu">ranger</span>(<span class="at">formula =</span> Survived <span class="sc">~</span> . ,  <span class="at">data =</span> titanic_training,</span>
<span id="cb659-2"><a href="maskinslæring-i-tidyverse.html#cb659-2" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">mtry =</span> <span class="dv">3</span>, </span>
<span id="cb659-3"><a href="maskinslæring-i-tidyverse.html#cb659-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">num.trees =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>Nu jeg kan endelige anvende modellen til at lave forudsigelser over min <code>titanic_test</code> datasæt. Så kan jeg får en “final” accuracy, som fortæller hvor god min model er at finde ud af hvem der overlevede tradgedien, baserede på de andre variabler.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="maskinslæring-i-tidyverse.html#cb660-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;actual&quot;</span><span class="ot">=</span>titanic_test<span class="sc">$</span>Survived,</span>
<span id="cb660-2"><a href="maskinslæring-i-tidyverse.html#cb660-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;predicted&quot;</span><span class="ot">=</span><span class="fu">predict</span>(final_RF,titanic_test)<span class="sc">$</span>predictions)</span>
<span id="cb660-3"><a href="maskinslæring-i-tidyverse.html#cb660-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb660-4"><a href="maskinslæring-i-tidyverse.html#cb660-4" aria-hidden="true" tabindex="-1"></a>predictions <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="st">&quot;accuracy&quot;</span><span class="ot">=</span><span class="fu">sum</span>(actual<span class="sc">==</span>predicted)<span class="sc">/</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   accuracy
##      &lt;dbl&gt;
## 1    0.821</code></pre>
<p>Så kan man se, at vi er faktisk god til at forudsige hvem, der overlevde tradgedien (se også de forskellige scores og analyser på Kaggle).</p>
</div>
<div id="variable-importance" class="section level3 hasAnchor" number="12.4.7">
<h3><span class="header-section-number">12.4.7</span> Variable importance<a href="maskinslæring-i-tidyverse.html#variable-importance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Den allersidste, som kan være nyttig at vide, er hvilke variabler var mest vigtig for at kunne lave en nøjagtig forudsigelse af hvem, der overlevede. Man kan tilføje en indstilling, der hedder <code>importance = "impurity"</code> til kommandoen i funktion <code>ranger</code>, som i følgende:</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="maskinslæring-i-tidyverse.html#cb662-1" aria-hidden="true" tabindex="-1"></a>final_RF <span class="ot">&lt;-</span> <span class="fu">ranger</span>(<span class="at">formula =</span> Survived <span class="sc">~</span> . ,  <span class="at">data =</span> titanic_training,</span>
<span id="cb662-2"><a href="maskinslæring-i-tidyverse.html#cb662-2" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">importance =</span> <span class="st">&quot;impurity&quot;</span>,</span>
<span id="cb662-3"><a href="maskinslæring-i-tidyverse.html#cb662-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">mtry =</span> <span class="dv">3</span>, </span>
<span id="cb662-4"><a href="maskinslæring-i-tidyverse.html#cb662-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">num.trees =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>Sidste vil vil gerne vide, bidragen af de forskellige variabler i modellen:</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="maskinslæring-i-tidyverse.html#cb663-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">t</span>(final_RF<span class="sc">$</span>variable.importance) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb663-2"><a href="maskinslæring-i-tidyverse.html#cb663-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> mod <span class="sc">%&gt;%</span></span>
<span id="cb663-3"><a href="maskinslæring-i-tidyverse.html#cb663-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>())</span>
<span id="cb663-4"><a href="maskinslæring-i-tidyverse.html#cb663-4" aria-hidden="true" tabindex="-1"></a>mod</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   name   value
##   &lt;chr&gt;  &lt;dbl&gt;
## 1 Pclass 29.7 
## 2 Sex    59.0 
## 3 Age    62.6 
## 4 Solo    6.10
## 5 Port    5.78
## 6 Fare   68.1</code></pre>
<p>Den højere værdien, jo vigtigere er variablen:</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="maskinslæring-i-tidyverse.html#cb665-1" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span></span>
<span id="cb665-2"><a href="maskinslæring-i-tidyverse.html#cb665-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>value,<span class="at">fill=</span>name)) <span class="sc">+</span> </span>
<span id="cb665-3"><a href="maskinslæring-i-tidyverse.html#cb665-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb665-4"><a href="maskinslæring-i-tidyverse.html#cb665-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>mod <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(name)) <span class="sc">+</span> </span>
<span id="cb665-5"><a href="maskinslæring-i-tidyverse.html#cb665-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="visualisering_22_files/figure-html/unnamed-chunk-672-1.png" width="480" /></p>
<p>Så kan man se, at variablen <code>Sex</code> er meget vigtig for at udgøre hvem, der overlede, hvilket er i ovenenstemmelse med vors undersøgelser med titanic fra tidligere emner!</p>
</div>
</div>
<div id="problemstillinger-11" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Problemstillinger<a href="maskinslæring-i-tidyverse.html#problemstillinger-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Problem 1)</strong>: Quiz - maskinslæring</p>
<hr />
<p><strong>Classification med penguins</strong></p>
<p><em>I datasættet “penguins” vil vi gerne anvende en classification model for at forudsige “male” og “female” pengvinger (variablen <code>sex</code>) ud fra de andre variabler i datasættet. Første åbne datasættet:</em></p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="maskinslæring-i-tidyverse.html#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb666-2"><a href="maskinslæring-i-tidyverse.html#cb666-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code></pre></div>
<p>OBS: <strong>Vi tilpasser koden tæt fra ovenstående eksempel med datasættet <code>titanic</code> - i følgende spørgsmål følg med koden fra Section 12.4</strong></p>
<hr />
<p><em>Lad os begynde med at opdele datasættet i to og brug testing data til at lave en “nested” dataframe som vi kan bruge til at lave 5-fold-cross-validation.</em></p>
<p><strong>Problem 2)</strong> <em>Set up cross-validation framework</em></p>
<p><strong>a)</strong> Opdel datasættet “penguins” i to, således at 80 procent af observationerne hører til det træning datasæt (og 20 procent hører til det testing datasæt). Kald dit resultat <code>penguins_split</code>. Hvor mange observationer er blevet allokeret til træning og testing datasæt?</p>
<p><strong>b)</strong> Udtræk de to datasæt fra <code>penguins_split</code> og kalder dem for <code>penguins_training</code> og <code>penguins_test</code>.</p>
<p><em>Vi lægger datasættet <code>penguins_test</code> til siden (vi får bruge for det senere), og arbejder kun med datasættet <code>penguins_training</code> for at udvikle vores model.</em></p>
<p><strong>c</strong>) Anvend <code>penguins_training</code> til at lave en 5-fold-cross-validation dataframe, der hedder <code>cv_split</code>.</p>
<p><strong>d</strong>) Udtræk de fem testing og training datasæt fra kolonnen <code>splits</code> og lagr dem i egne kolonner (kald deres kolonner for henholdvis <code>validate</code> og <code>train</code>). Kald din nye “nested” dataframe for <code>cv_data</code>.</p>
<hr />
<p><em>Nu vil vi gerne lave samme model 5 gange - en gang til hvert datasæt i kolonnen <code>train</code> i vores nye <code>cv_data</code> dataframe. Den model skal være en ‘classification’ model, når vi gerne vil forudsige “male” eller “female” pingviner (vores afhængig variabel er <code>sex</code> som er kategorisk med to mulige værdier).</em></p>
<p><strong>Problem 3)</strong> <em>Set-up modellen</em></p>
<p><strong>a</strong>) Lad os starte med det første datasæt og generaliser bagefter til en custom funktion i <strong>b</strong>). Anvend <code>pluck</code> for at få frem til det første datasæt i kolonnen <code>train</code>, og dernæst anvende funktionen <code>ranger</code> for at lave en classifikation model med variablen <code>sex</code> som afhængig variable, og med alle de andre variabler som uafhængige variabler (betegnet med <code>~ .</code> i modellen). Angiv <code>num.trees=100</code> (vi ignorerer andre mulige parametre indtil videre).</p>
<p><strong>b</strong>) Når vi har fået modellen med <code>ranger</code> til at virke på det første datasæt laver vi en custom funktion der kan anvendes over samtlige datasæt i kolonnen <code>train</code> - tilpas din <code>ranger</code> model fra <strong>a)</strong> til en custom funktion og kalder den for <code>ranger_function</code>.</p>
<p><strong>c</strong>) Anvend <code>ranger_function</code> på samtlige datasæt i kolonne “train” (opret en ny kolonne i<code>cv_data</code>, der hedder <code>model</code> hvor dine fem modeller bliver lagret).</p>
<hr />
<p><em>Nu har vi lavet en classification model til hvert træning sæt! Vi vil gerne vide, hvor gode modellerne er til at forudsige <code>sex</code> i de fem datasæts i kolonnen <code>validate</code> (husk at <code>validate</code> indeholder det styk, der ikke var brugt i training til den relevant <code>id</code>(fold)). Vi skal sammenligne to ting fra vores validate sæt - hvad er vores forudsigelser ud fra modellerne (“male” eller “female” til hver pingvin), og hvad er de virkelige værdier for variablen <code>sex</code> (igen “male” eller “female”).</em></p>
<p><strong>Problem 4)</strong> <em>Make predictions from model</em></p>
<p><strong>a</strong>) Brug <code>map</code>/<code>map2</code> til at lave to nye kolonner i <code>cv_data</code>:</p>
<ul>
<li><code>actual</code> hvor du udtrækker de virkelige værdier for variablen <code>sex</code></li>
<li><code>prediction</code> hvor du anvender <code>predict</code> med din models (betegnet som .x) og dine validate sæt (betegnet som .y)</li>
</ul>
<p><strong>b</strong>) Udvælg <code>id</code>, <code>actual</code> og <code>prediction</code>, unnest og beregn “accuracy” (proportionen svar, der er rigtige) til hvert af de 5 folds.</p>
<p><strong>c</strong>) Lav et barplot for at se din accuracies over de 5-folds.</p>
<hr />
<p><em>Nu har vi lavet 5-fold-cross validation til at træne en classification model. Vi kunne godt tænke os at udvide processen lidt, fordi der er nogle parametre der kan ændres på i funktionen <code>ranger</code>. Det er gennem den her ‘udviklingsproces’ hvor vi begynder at forstå fordelen af at bruge cross-fold-validation. Lad os prøve at ændre på parameten <code>mtry</code> for at se, om vi kan gøre modellen bedre. Igen følger vi meget tæt på ovenstående kurusnotaterne.</em></p>
<p><strong>Problm 5)</strong> Tune parameteren <code>mtry</code>.</p>
<p><strong>a</strong>) Anvend funktionen <code>crossing</code> til at inddrage <code>mtry</code> (fra 2 til 6 som er antal uafhængig variabler) som kolonne i <code>cv_data</code>. Kald din nye dataframe for <code>cv_tune</code>. Hvor mange datasæt er der nu i kolonnen <code>train</code>?</p>
<p><strong>b</strong>) Tilpas din custom ranger funktion fra <strong>Spørgsmål 3</strong> hvor du nu inddrager parameteren <code>mtry</code> (med værdi betegnet som <code>.y</code>) og anvende din model på de forskellige training sæt i kolonnen <code>train</code> for hver mulig værdi af <code>mtry</code> (husk at bruge <code>map2</code> her).</p>
<p><strong>c</strong>) Lav forudsigelser ud fra samtlige modeller og dine validation sæt (kolonnen <code>validate</code>) og udtræk både dine “actual” og “predicted” værdier præcis ligesom før.</p>
<p><strong>d</strong>) Beregn accuracy for samtlige sæt (alle kombinationer af <code>id</code> og <code>mtry</code>), lav et stacked barplot og vælg den bedste mulige værdi for <code>mtry</code>.</p>
<hr />
<p><em>Nu at vi har valgt en værdi for parameteren <code>mtry</code>, lad os går henne og lav en “final” model! Når vi har lavet den final model kan vi endelig kigge på vores <code>penguins_test</code> datasæt, som vi lagt tidligere til siden. Husk at validate sæts var brugt til at teste modellen undervejs i udviklingsprocessen, men de var stadig en del af <code>penguins_training</code>. Man kigger på den testing datasæt kun én gang til sidste for at spørge - hvor god er vores endelige model?</em></p>
<p><strong>Problem 6)</strong> <em>Lave en <code>final</code> model</em></p>
<p><strong>a</strong>) Anvende funktionen <code>ranger</code> til at lave en classifcation model på datasættet <code>penguins_training</code>. Angiv <code>num.trees=100</code> og din valgt værdi for parameteren <code>mtry</code>.</p>
<p><strong>b</strong>) Lav predictions med funktionen <code>predict</code> hvor du angiv din “final” model samt dit “penguins_test” datasæt. Beregen accuracy fra din model ved at sammenligne de virkelige værdier for variablen <code>sex</code> i dit testing sæt med din beregnede værdier fra <code>predict()</code>.</p>
<hr />
<p><em>Nu at vi er færdig med at lave og bedømme vores “final” model er vi interesseret i - hvilke variabler havde den største indflydelse på vores forudsigelser af “male” og “female” pingviner?</em></p>
<p><strong>Problem 7)</strong> <em>Variable importance</em></p>
<p><strong>a</strong>) Tag din funktion til din “final” model og angiv indstillingen <code>importance = "impurity"</code> i funktionen. Kør modellen og udtræk din variable importance vector med <code>final_RF$variable.importance</code>.</p>
<p><strong>b</strong>) Omsæt din importance scores til et barplot hvor du angiv rækkefølgen af søjlerne efter vigtigheden af de forskellige variabler (den meste vigtig til venstre).</p>
<hr />
<p><strong>Problem 8)</strong> Gentag samme process i et andet datasæt men i en regression contekst:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="maskinslæring-i-tidyverse.html#cb667-1" aria-hidden="true" tabindex="-1"></a>LungCapData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.dropbox.com/s/ke27fs5d37ks1hm/LungCapData.csv?dl=1&quot;</span>)</span>
<span id="cb667-2"><a href="maskinslæring-i-tidyverse.html#cb667-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(LungCapData)</span></code></pre></div>
<pre><code>## Rows: 725
## Columns: 6
## $ LungCap   &lt;dbl&gt; 6.475, 10.125, 9.550, 11.125, 4.800, 6.225, 4.950, 7.325, 8.…
## $ Age       &lt;int&gt; 6, 18, 16, 14, 5, 11, 8, 11, 15, 11, 19, 17, 12, 10, 10, 13,…
## $ Height    &lt;dbl&gt; 62.1, 74.7, 69.7, 71.0, 56.9, 58.7, 63.3, 70.4, 70.5, 59.2, …
## $ Smoke     &lt;chr&gt; &quot;no&quot;, &quot;yes&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;,…
## $ Gender    &lt;chr&gt; &quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;male&quot;…
## $ Caesarean &lt;chr&gt; &quot;no&quot;, &quot;no&quot;, &quot;yes&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;, &quot;yes&quot;, &quot;no&quot;, &quot;no&quot;, &quot;no&quot;…</code></pre>
<p>Følg processen fra Sektion 12.3 igennem med datasættet <code>LungCapData</code>:</p>
<ul>
<li>forudsige <code>LungCap</code> som afhængig variabel og alle andre variabler som uafhængig variabler</li>
<li>Splitte datasættet (75% training, 25% testing) og anvend 10-fold cross-validation på dit training datasæt</li>
<li>Beregn “mean absolute error” for dine forskellige folds</li>
<li>Lav en færdig model og beregn “mean absolute error”</li>
</ul>
</div>
<div id="yderligere-kommentarer-og-pakker" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Yderligere kommentarer og pakker<a href="maskinslæring-i-tidyverse.html#yderligere-kommentarer-og-pakker" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Jeg spang over mange nyttige pakker og funktioner, der kan bruges til at lave maskinslæring processer i R</p>
<ul>
<li><code>Yardstick</code>-pakken er til metrics - fk. accuracy/precesion/recall osv. man kan også lave ROC curves osv. Jeg anvendte kun accuracy i kurset (til at vise processen/iden men begrænser overordnet læs i emnet) men man plejer at anvende forskellige metrics i virkeligheden.</li>
<li><code>Tidymodels</code>-pakken er en generel pakke, hvor man få en “fælles” tilgang til at opbygge modeller der stammer fra mange forskellige pakke - man kan fk. bruge samme tilgang til at lave blandt andet regression eller bayesian modeller, random forest, support vector machines osv. - alle modeller har nu samme syntaksen i den <code>Tidymodels</code> tilgang.</li>
<li>Der er mange bøger der handler om machine learning n the tidyverse, fk. se her <a href="https://livebook.manning.com/book/machine-learning-for-mortals-mere-and-otherwise/chapter-1/v-4/1" class="uri">https://livebook.manning.com/book/machine-learning-for-mortals-mere-and-otherwise/chapter-1/v-4/1</a></li>
</ul>
<!-- ```{r} -->
<!-- data = read.csv("https://www.dropbox.com/s/1km3x2hd55eoty4/heart_cleveland_upload.csv?dl=1") -->
<!-- data <- as_tibble(data) -->
<!-- data <- data %>% filter(thal>0) -->
<!-- data <- data %>% mutate(slope = recode(slope,`0`="upsloping",`1`="flat",`2`="downsloping"), -->
<!--                         restecg = recode(restecg,`0`="normal",`1`="stt",`2`="hypertrophy"), -->
<!--                         exang = recode(exang, `0`="no", `1`="yes"), -->
<!--                         thal = recode(thal, `1`="normal", `2`="fixed", `3`="reversible")) -->
<!-- data <- data %>% mutate(sex = recode(sex,`0` = "female",`1` = "male"), -->
<!--                         condition = recode(condition,`0` = "no",`1` = "yes"), -->
<!--                         condition = factor(condition,levels=c("yes","no")), -->
<!--                         fbs = recode(fbs,`0`="false",`1`="true"), -->
<!--                         cp = recode(cp,`0`="typical_ang",`1`="atypical_ang",`2`="non_anginal_pain",`3`="asymptomatic")) -->
<!-- heart <- data -->
<!-- ``` -->
<!-- __Problem 2)__ (split data) -->
<!-- ```{r} -->
<!-- heart_split <- initial_split(heart, prop = 0.75) -->
<!-- heart_training <- heart_split %>% training() -->
<!-- heart_test <- heart_split %>% testing() -->
<!-- ``` -->
<!-- __Problem 3)__  make cross-validation dataframe -->
<!-- ```{r,set.seed=333} -->
<!-- cv_split <- vfold_cv(heart_training, v = 5) -->
<!-- cv_data <- cv_split %>%  -->
<!--   mutate( -->
<!--     train = map(splits, ~training(.x)),  -->
<!--     validate = map(splits, ~testing(.x)) -->
<!--   ) -->
<!-- cv_data -->
<!-- ``` -->
<!-- __Problem 5)__ make classification model -->
<!-- ```{r} -->
<!-- ranger_model <- ~ranger(formula = condition ~.,  -->
<!--                                               data = .x, -->
<!--                                               num.trees = 100) -->
<!-- cv_models_rf <- cv_data %>%  -->
<!--   mutate(model = map(train, ranger_model)) -->
<!-- ``` -->
<!-- __Problem 6)__ make predictions -->
<!-- ```{r} -->
<!-- cv_prep_rf <- cv_models_rf %>%  -->
<!--   mutate( -->
<!--     validate_actual = map(validate, ~.x %>% pull(condition)), -->
<!--     validate_predicted = map2(.x = model, .y = validate, ~predict(.x, .y)$predictions) -->
<!--   ) -->
<!-- predictions <- cv_prep_rf %>% select(id,validate_predicted,validate_actual) %>% unnest(validate_predicted,validate_actual) -->
<!-- ``` -->
<!-- __Problem 7)__ prediction visualiation -->
<!-- ```{r} -->
<!-- my_metrics <- yardstick::metric_set(accuracy,precision,recall) -->
<!-- my_metrics_results <- predictions %>% group_by(id) %>% my_metrics(truth = validate_actual,estimate=validate_predicted) -->
<!-- my_metrics_results -->
<!-- my_metrics_results %>%  -->
<!-- ggplot(aes(x=.metric,y=.estimate,fill=id)) +   -->
<!--   geom_bar(stat="identity",position="dodge",colour="black") +  -->
<!--   theme_bw() -->
<!-- ``` -->
<!-- __Problem 9)__ Make final model and test -->
<!-- ```{r} -->
<!-- final_RF <- ranger(formula = condition ~ . ,  # ~ . betyder all variabler i datasættet som afhængig -->
<!--                                               data = heart_training, -->
<!--                                               mtry = 3,  -->
<!--                                               importance = "impurity", -->
<!--                                               num.trees = 100) -->
<!-- predictions <- tibble("actual"=heart_test$condition,"predicted"=predict(final_RF, heart_test)$predictions) -->
<!-- predictions %>% my_metrics(truth=actual,estimate=predicted) -->
<!-- ``` -->
<!-- __Problem 9)__ variable importance -->
<!-- ```{r} -->
<!-- mod <- cv_prep_rf %>% pluck("model",1) -->
<!-- mod$variable.importance -->
<!-- ``` -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="emner-fra-eksperimental-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="presæntering-af-datasæt-over-for-andre.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["visualisering_22.pdf", "visualisering_22.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
